<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebMaster Pro - Ultimate Visual Editor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
        }

        /* Main Container */
        .editor-container {
            display: flex;
            height: 100vh;
            width: 100vw;
        }

        /* Top Header */
        .top-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .project-info h2 {
            font-size: 18px;
            color: #333;
            margin: 0;
        }

        .project-info p {
            font-size: 12px;
            color: #666;
            margin: 0;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .website-selector {
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 8px 15px;
            font-size: 14px;
            color: #333;
            min-width: 200px;
            outline: none;
            transition: all 0.3s ease;
        }

        .website-selector:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .action-btn.success {
            background: linear-gradient(45deg, #26de81, #20bf6b);
        }

        .action-btn.warning {
            background: linear-gradient(45deg, #fed330, #f7b733);
        }

        /* Left Sidebar */
        .left-sidebar {
            width: 300px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            padding: 20px;
            overflow-y: auto;
            margin-top: 60px;
            height: calc(100vh - 60px);
        }

        .sidebar-section {
            margin-bottom: 25px;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: #667eea;
            font-size: 18px;
        }

        /* Pages Management */
        .pages-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .page-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .page-item:hover {
            background: #e3f2fd;
            border-color: #667eea;
        }

        .page-item.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .page-controls {
            display: flex;
            gap: 5px;
        }

        .page-controls button {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .page-controls button:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .add-page-btn {
            background: linear-gradient(45deg, #26de81, #20bf6b);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .add-page-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(38, 222, 129, 0.4);
        }

        /* Components Library */
        .components-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .component-item {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .component-item:hover {
            background: #e3f2fd;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .component-item i {
            font-size: 24px;
            color: #667eea;
            margin-bottom: 8px;
        }

        .component-item span {
            display: block;
            font-size: 12px;
            color: #666;
            font-weight: 600;
        }

        /* Media Manager */
        .media-upload {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .media-upload:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }

        .media-upload i {
            font-size: 40px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .media-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .media-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .media-item:hover {
            background: #e3f2fd;
            transform: scale(1.05);
        }

        .media-item img {
            width: 100%;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 5px;
        }

        /* Main Editor Area */
        .main-editor {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-top: 60px;
            height: calc(100vh - 60px);
        }

        .editor-toolbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .device-controls {
            display: flex;
            gap: 10px;
        }

        .device-btn {
            background: white;
            border: 1px solid #e1e5e9;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .device-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .zoom-slider {
            width: 100px;
        }

        /* Canvas Area */
        .canvas-area {
            flex: 1;
            background: #f5f6fa;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: auto;
        }

        .canvas-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            max-width: 100%;
            max-height: 100%;
            overflow: hidden;
        }

        .canvas-container.desktop {
            width: 1200px;
            height: 800px;
        }

        .canvas-container.tablet {
            width: 768px;
            height: 1024px;
        }

        .canvas-container.mobile {
            width: 375px;
            height: 667px;
        }

        #previewFrame {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 10px;
        }

        /* Right Properties Panel */
        .right-panel {
            width: 320px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.2);
            padding: 20px;
            overflow-y: auto;
            margin-top: 60px;
            height: calc(100vh - 60px);
        }

        .property-group {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .property-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .property-title i {
            color: #667eea;
            font-size: 16px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            color: #666;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .color-input {
            width: 100%;
            height: 40px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            cursor: pointer;
        }

        .range-input {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e1e5e9;
            outline: none;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .style-btn {
            background: white;
            border: 1px solid #e1e5e9;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }

        .style-btn:hover {
            background: #f8f9fa;
            border-color: #667eea;
        }

        .style-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* AI Assistant */
        .ai-assistant {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .ai-assistant:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .ai-assistant i {
            color: white;
            font-size: 24px;
        }

        .ai-chat {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 350px;
            height: 400px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
            z-index: 999;
            flex-direction: column;
        }

        .ai-chat.active {
            display: flex;
        }

        .ai-header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .ai-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .ai-input-area {
            padding: 15px 20px;
            border-top: 1px solid #e1e5e9;
            display: flex;
            gap: 10px;
        }

        .ai-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            outline: none;
        }

        .ai-send {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transform: translateX(400px);
            transition: all 0.3s ease;
            z-index: 1001;
            border-left: 4px solid #667eea;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left-color: #26de81;
        }

        .notification.error {
            border-left-color: #ff3838;
        }

        .notification.warning {
            border-left-color: #fed330;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .left-sidebar, .right-panel {
                display: none;
            }
            
            .main-editor {
                margin-top: 60px;
            }
        }

        /* Loading Animation */
        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1002;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Editable Elements Styles */
        .editable {
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            border-radius: 4px;
        }

        .editable:hover {
            outline: 2px dashed rgba(102, 126, 234, 0.5);
            background: rgba(102, 126, 234, 0.05) !important;
        }

        .editable.selected {
            outline: 3px solid #667eea !important;
            background: rgba(102, 126, 234, 0.1) !important;
        }

        .editable[contenteditable="true"] {
            outline: 3px solid #26de81 !important;
            background: rgba(38, 222, 129, 0.1) !important;
        }
    </style>
</head>
<body>
    <!-- Top Header -->
    <div class="top-header">
        <div class="logo-section">
            <div class="logo">
                <i class="fas fa-magic"></i>
            </div>
            <div class="project-info">
                <h2>WebMaster Pro</h2>
                <p>Ultimate Visual Editor</p>
            </div>
        </div>

        <div class="header-controls">
            <select class="website-selector" id="websiteSelector">
                <option value="">בחר אתר לעריכה</option>
                <option value="dr-michal-rosen">ד"ר מיכל רוזן - אסתטיקה רפואית (₪2,800)</option>
                <option value="fitness-co">דני פיט - מאמן כושר (₪2,200)</option>
                <option value="yoga-studio">סטודיו אוהם - יוגה (₪1,900)</option>
                <option value="nutritionist">ד"ר שרה כהן - תזונאית (₪2,400)</option>
                <option value="law-firm">משרד ברקוביץ - עו"ד (₪2,500)</option>
                <option value="accountant">רינה לוי - חשבת שכר (₪2,000)</option>
                <option value="beauty-salon">מספרה BELLA - יופי (₪1,700)</option>
                <option value="tutor">ד"ר רונית לוי - מורה פרטית (₪2,100)</option>
                <option value="aesthetic-clinic">קליניקת יופי פרמיום (₪3,200)</option>
                <option value="multibrawn">מולטיבראון - נופש (₪2,300)</option>
                <option value="real-estate">נדל"ן פרמיום (₪2,700)</option>
            </select>

            <div class="action-buttons">
                <button class="action-btn" onclick="undoAction()">
                    <i class="fas fa-undo"></i>
                    ביטול
                </button>
                <button class="action-btn" onclick="redoAction()">
                    <i class="fas fa-redo"></i>
                    חזרה
                </button>
                <button class="action-btn success" onclick="saveProject()">
                    <i class="fas fa-save"></i>
                    שמירה
                </button>
                <button class="action-btn warning" onclick="publishSite()">
                    <i class="fas fa-rocket"></i>
                    פרסום
                </button>
                <button class="action-btn" onclick="previewSite()">
                    <i class="fas fa-eye"></i>
                    תצוגה
                </button>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="editor-container">
        <!-- Left Sidebar -->
        <div class="left-sidebar">
            <!-- Pages Management -->
            <div class="sidebar-section">
                <div class="section-title">
                    <i class="fas fa-copy"></i>
                    ניהול דפים
                </div>
                <div class="pages-list" id="pagesList">
                    <div class="page-item active">
                        <span>עמוד הבית</span>
                        <div class="page-controls">
                            <button title="ערוך"><i class="fas fa-edit"></i></button>
                            <button title="שכפל"><i class="fas fa-copy"></i></button>
                            <button title="מחק"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div class="page-item">
                        <span>אודות</span>
                        <div class="page-controls">
                            <button title="ערוך"><i class="fas fa-edit"></i></button>
                            <button title="שכפל"><i class="fas fa-copy"></i></button>
                            <button title="מחק"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div class="page-item">
                        <span>שירותים</span>
                        <div class="page-controls">
                            <button title="ערוך"><i class="fas fa-edit"></i></button>
                            <button title="שכפל"><i class="fas fa-copy"></i></button>
                            <button title="מחק"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div class="page-item">
                        <span>צור קשר</span>
                        <div class="page-controls">
                            <button title="ערוך"><i class="fas fa-edit"></i></button>
                            <button title="שכפל"><i class="fas fa-copy"></i></button>
                            <button title="מחק"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
                <button class="add-page-btn" onclick="addNewPage()">
                    <i class="fas fa-plus"></i>
                    הוסף דף חדש
                </button>
            </div>

            <!-- Components Library -->
            <div class="sidebar-section">
                <div class="section-title">
                    <i class="fas fa-shapes"></i>
                    ספריית רכיבים
                </div>
                <div class="components-grid">
                    <div class="component-item" onclick="addComponent('hero')">
                        <i class="fas fa-star"></i>
                        <span>Hero Section</span>
                    </div>
                    <div class="component-item" onclick="addComponent('text')">
                        <i class="fas fa-font"></i>
                        <span>טקסט</span>
                    </div>
                    <div class="component-item" onclick="addComponent('image')">
                        <i class="fas fa-image"></i>
                        <span>תמונה</span>
                    </div>
                    <div class="component-item" onclick="addComponent('gallery')">
                        <i class="fas fa-images"></i>
                        <span>גלריה</span>
                    </div>
                    <div class="component-item" onclick="addComponent('video')">
                        <i class="fas fa-video"></i>
                        <span>וידאו</span>
                    </div>
                    <div class="component-item" onclick="addComponent('button')">
                        <i class="fas fa-mouse-pointer"></i>
                        <span>כפתור</span>
                    </div>
                    <div class="component-item" onclick="addComponent('form')">
                        <i class="fas fa-envelope"></i>
                        <span>טופס</span>
                    </div>
                    <div class="component-item" onclick="addComponent('map')">
                        <i class="fas fa-map"></i>
                        <span>מפה</span>
                    </div>
                    <div class="component-item" onclick="addComponent('testimonials')">
                        <i class="fas fa-quote-right"></i>
                        <span>המלצות</span>
                    </div>
                    <div class="component-item" onclick="addComponent('pricing')">
                        <i class="fas fa-tags"></i>
                        <span>מחירון</span>
                    </div>
                    <div class="component-item" onclick="addComponent('team')">
                        <i class="fas fa-users"></i>
                        <span>צוות</span>
                    </div>
                    <div class="component-item" onclick="addComponent('blog')">
                        <i class="fas fa-blog"></i>
                        <span>בלוג</span>
                    </div>
                </div>
            </div>

            <!-- Media Manager -->
            <div class="sidebar-section">
                <div class="section-title">
                    <i class="fas fa-photo-video"></i>
                    ניהול מדיה
                </div>
                <div class="media-upload" onclick="uploadMedia()">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>גרור קבצים כאן או לחץ להעלאה</p>
                    <small>תמונות, וידאו, או מסמכים</small>
                </div>
                <div class="media-grid" id="mediaGrid">
                    <div class="media-item" onclick="selectMedia('image1')">
                        <img src="https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=300&h=200&fit=crop" alt="תמונה 1">
                        <small>תמונה 1</small>
                    </div>
                    <div class="media-item" onclick="selectMedia('image2')">
                        <img src="https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=300&h=200&fit=crop" alt="תמונה 2">
                        <small>תמונה 2</small>
                    </div>
                    <div class="media-item" onclick="selectMedia('image3')">
                        <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=300&h=200&fit=crop" alt="תמונה 3">
                        <small>תמונה 3</small>
                    </div>
                    <div class="media-item" onclick="selectMedia('image4')">
                        <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop" alt="תמונה 4">
                        <small>תמונה 4</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Editor Area -->
        <div class="main-editor">
            <!-- Editor Toolbar -->
            <div class="editor-toolbar">
                <div class="device-controls">
                    <button class="device-btn active" onclick="setDevice('desktop')">
                        <i class="fas fa-desktop"></i>
                        מחשב
                    </button>
                    <button class="device-btn" onclick="setDevice('tablet')">
                        <i class="fas fa-tablet-alt"></i>
                        טאבלט
                    </button>
                    <button class="device-btn" onclick="setDevice('mobile')">
                        <i class="fas fa-mobile-alt"></i>
                        מובייל
                    </button>
                </div>

                <div class="zoom-controls">
                    <span>זום:</span>
                    <input type="range" class="zoom-slider" min="25" max="200" value="100" id="zoomSlider" oninput="updateZoom(this.value)">
                    <span id="zoomValue">100%</span>
                </div>
            </div>

            <!-- Canvas Area -->
            <div class="canvas-area">
                <div class="canvas-container desktop" id="canvasContainer">
                    <iframe id="previewFrame" src="about:blank"></iframe>
                </div>
            </div>
        </div>

        <!-- Right Properties Panel -->
        <div class="right-panel">
            <!-- Element Properties -->
            <div class="property-group">
                <div class="property-title">
                    <i class="fas fa-edit"></i>
                    מאפיני אלמנט
                </div>
                <div class="form-group">
                    <label>טקסט</label>
                    <input type="text" class="form-control" id="elementText" placeholder="הכנס טקסט..." oninput="updateElementText(this.value)">
                </div>
                <div class="form-group">
                    <label>קישור (URL)</label>
                    <input type="url" class="form-control" id="elementLink" placeholder="https://" oninput="updateElementLink(this.value)">
                </div>
            </div>

            <!-- Typography -->
            <div class="property-group">
                <div class="property-title">
                    <i class="fas fa-font"></i>
                    טיפוגרפיה
                </div>
                <div class="form-group">
                    <label>פונט</label>
                    <select class="form-control" id="fontFamily" onchange="updateFontFamily(this.value)">
                        <option value="inherit">ברירת מחדל</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="'Segoe UI', sans-serif">Segoe UI</option>
                        <option value="'Helvetica Neue', sans-serif">Helvetica</option>
                        <option value="'Times New Roman', serif">Times</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="'Courier New', monospace">Courier</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>גודל פונט: <span id="fontSizeValue">16px</span></label>
                    <input type="range" class="range-input" min="12" max="72" value="16" id="fontSize" oninput="updateFontSize(this.value)">
                </div>
                <div class="form-group">
                    <label>משקל פונט</label>
                    <div class="button-group">
                        <button class="style-btn" onclick="toggleFontWeight('normal')">רגיל</button>
                        <button class="style-btn" onclick="toggleFontWeight('bold')">עבה</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>סגנון פונט</label>
                    <div class="button-group">
                        <button class="style-btn" onclick="toggleFontStyle('normal')">רגיל</button>
                        <button class="style-btn" onclick="toggleFontStyle('italic')">נטוי</button>
                    </div>
                </div>
            </div>

            <!-- Colors -->
            <div class="property-group">
                <div class="property-title">
                    <i class="fas fa-palette"></i>
                    צבעים
                </div>
                <div class="form-group">
                    <label>צבע טקסט</label>
                    <input type="color" class="color-input" id="textColor" value="#333333" onchange="updateTextColor(this.value)">
                </div>
                <div class="form-group">
                    <label>צבע רקע</label>
                    <input type="color" class="color-input" id="bgColor" value="#ffffff" onchange="updateBgColor(this.value)">
                </div>
                <div class="form-group">
                    <label>צבע גבול</label>
                    <input type="color" class="color-input" id="borderColor" value="#cccccc" onchange="updateBorderColor(this.value)">
                </div>
            </div>

            <!-- Layout & Spacing -->
            <div class="property-group">
                <div class="property-title">
                    <i class="fas fa-expand-arrows-alt"></i>
                    פריסה ומרווחים
                </div>
                <div class="form-group">
                    <label>רפידה פנימית: <span id="paddingValue">10px</span></label>
                    <input type="range" class="range-input" min="0" max="50" value="10" id="padding" oninput="updatePadding(this.value)">
                </div>
                <div class="form-group">
                    <label>רפידה חיצונית: <span id="marginValue">10px</span></label>
                    <input type="range" class="range-input" min="0" max="50" value="10" id="margin" oninput="updateMargin(this.value)">
                </div>
                <div class="form-group">
                    <label>עובי גבול: <span id="borderWidthValue">1px</span></label>
                    <input type="range" class="range-input" min="0" max="10" value="1" id="borderWidth" oninput="updateBorderWidth(this.value)">
                </div>
                <div class="form-group">
                    <label>עיגול פינות: <span id="borderRadiusValue">5px</span></label>
                    <input type="range" class="range-input" min="0" max="50" value="5" id="borderRadius" oninput="updateBorderRadius(this.value)">
                </div>
            </div>

            <!-- Effects -->
            <div class="property-group">
                <div class="property-title">
                    <i class="fas fa-magic"></i>
                    אפקטים
                </div>
                <div class="form-group">
                    <label>שקיפות: <span id="opacityValue">100%</span></label>
                    <input type="range" class="range-input" min="0" max="100" value="100" id="opacity" oninput="updateOpacity(this.value)">
                </div>
                <div class="form-group">
                    <label>צל</label>
                    <div class="button-group">
                        <button class="style-btn" onclick="toggleShadow('none')">ללא</button>
                        <button class="style-btn" onclick="toggleShadow('small')">קטן</button>
                        <button class="style-btn" onclick="toggleShadow('large')">גדול</button>
                    </div>
                </div>
            </div>

            <!-- AI Suggestions -->
            <div class="property-group">
                <div class="property-title">
                    <i class="fas fa-robot"></i>
                    הצעות AI
                </div>
                <button class="action-btn" onclick="aiOptimize()" style="width: 100%; margin-bottom: 10px;">
                    <i class="fas fa-magic"></i>
                    אופטימיזציה אוטומטית
                </button>
                <button class="action-btn success" onclick="aiGenerateContent()" style="width: 100%; margin-bottom: 10px;">
                    <i class="fas fa-pen"></i>
                    יצירת תוכן
                </button>
                <button class="action-btn warning" onclick="aiColorScheme()" style="width: 100%;">
                    <i class="fas fa-palette"></i>
                    צבעים חכמים
                </button>
            </div>
        </div>
    </div>

    <!-- AI Assistant -->
    <div class="ai-assistant" onclick="toggleAI()">
        <i class="fas fa-robot"></i>
    </div>

    <div class="ai-chat" id="aiChat">
        <div class="ai-header">
            <span>🤖 AI Assistant</span>
            <button onclick="toggleAI()" style="background: none; border: none; color: white; cursor: pointer;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="ai-messages" id="aiMessages">
            <div style="background: #f0f0f0; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                שלום! אני כאן לעזור לך לבנות אתר מהמם. מה תרצה לעשות היום?
            </div>
        </div>
        <div class="ai-input-area">
            <input type="text" class="ai-input" id="aiInput" placeholder="שאל משהו...">
            <button class="ai-send" onclick="sendAIMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>טוען...</p>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notificationText">הודעה</span>
    </div>

    <script>
        // Global Variables
        let currentWebsite = null;
        let selectedElement = null;
        let currentDevice = 'desktop';
        let zoomLevel = 100;
        let undoStack = [];
        let redoStack = [];
        let aiActive = false;

        // Website Data
        const websites = {
            'dr-michal-rosen': {
                name: 'ד"ר מיכל רוזן',
                category: 'אסתטיקה רפואית',
                price: 2800,
                file: 'websites/dr-michal-rosen.html'
            },
            'fitness-co': {
                name: 'דני פיט',
                category: 'מאמן כושר',
                price: 2200,
                file: 'websites/fitness-co.html'
            },
            'yoga-studio': {
                name: 'סטודיו אוהם',
                category: 'יוגה',
                price: 1900,
                file: 'websites/yoga-studio.html'
            },
            'nutritionist': {
                name: 'ד"ר שרה כהן',
                category: 'תזונאית',
                price: 2400,
                file: 'websites/nutritionist.html'
            },
            'law-firm': {
                name: 'משרד ברקוביץ',
                category: 'עו"ד',
                price: 2500,
                file: 'websites/law-firm.html'
            },
            'accountant': {
                name: 'רינה לוי',
                category: 'חשבת שכר',
                price: 2000,
                file: 'websites/accountant.html'
            },
            'beauty-salon': {
                name: 'מספרה BELLA',
                category: 'יופי',
                price: 1700,
                file: 'websites/beauty-salon.html'
            },
            'tutor': {
                name: 'ד"ר רונית לוי',
                category: 'מורה פרטית',
                price: 2100,
                file: 'websites/tutor.html'
            },
            'aesthetic-clinic': {
                name: 'קליניקת יופי פרמיום',
                category: 'אסתטיקה',
                price: 3200,
                file: 'websites/aesthetic-clinic.html'
            },
            'multibrawn': {
                name: 'מולטיבראון',
                category: 'נופש',
                price: 2300,
                file: 'websites/multibrawn.html'
            },
            'real-estate': {
                name: 'נדל"ן פרמיום',
                category: 'נדל"ן',
                price: 2700,
                file: 'websites/real-estate.html'
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            loadDefaultWebsite();
            showNotification('ברוך הבא ל-WebMaster Pro! בחר אתר להתחלת העריכה.', 'success');
        });

        function setupEventListeners() {
            // Website selector
            document.getElementById('websiteSelector').addEventListener('change', function() {
                const websiteId = this.value;
                if (websiteId) {
                    loadWebsite(websiteId);
                }
            });

            // AI input
            document.getElementById('aiInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendAIMessage();
                }
            });

            // Auto-save
            setInterval(autoSave, 30000);
        }

        // Website Loading
        function loadWebsite(websiteId) {
            if (!websites[websiteId]) {
                showNotification('אתר לא נמצא', 'error');
                return;
            }

            showLoading(true);
            currentWebsite = websiteId;

            // Create demo HTML for now (in real app, load from file)
            const demoHTML = createDemoHTML(websites[websiteId]);
            
            const frame = document.getElementById('previewFrame');
            frame.srcdoc = demoHTML;
            
            frame.onload = function() {
                setupEditableElements();
                showLoading(false);
                showNotification(`אתר ${websites[websiteId].name} נטען בהצלחה!`, 'success');
            };
        }

        function createDemoHTML(website) {
            return `
                <!DOCTYPE html>
                <html lang="he" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>${website.name}</title>
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { 
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            line-height: 1.6;
                            color: #333;
                        }
                        .hero {
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            padding: 100px 20px;
                            text-align: center;
                            min-height: 80vh;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            flex-direction: column;
                        }
                        .hero h1 {
                            font-size: 3.5rem;
                            margin-bottom: 1rem;
                            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                        }
                        .hero p {
                            font-size: 1.3rem;
                            margin-bottom: 2rem;
                            max-width: 600px;
                        }
                        .cta-button {
                            background: white;
                            color: #667eea;
                            padding: 15px 40px;
                            border: none;
                            border-radius: 50px;
                            font-size: 1.1rem;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.3s ease;
                            text-decoration: none;
                            display: inline-block;
                        }
                        .cta-button:hover {
                            transform: translateY(-2px);
                            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                        }
                        .section {
                            padding: 80px 20px;
                            max-width: 1200px;
                            margin: 0 auto;
                        }
                        .section h2 {
                            font-size: 2.5rem;
                            text-align: center;
                            margin-bottom: 3rem;
                            color: #333;
                        }
                        .services {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                            gap: 2rem;
                            margin-top: 2rem;
                        }
                        .service {
                            background: white;
                            padding: 2rem;
                            border-radius: 15px;
                            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
                            text-align: center;
                            transition: all 0.3s ease;
                        }
                        .service:hover {
                            transform: translateY(-5px);
                            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
                        }
                        .service h3 {
                            font-size: 1.5rem;
                            margin-bottom: 1rem;
                            color: #667eea;
                        }
                        .service p {
                            color: #666;
                            line-height: 1.6;
                        }
                        .contact {
                            background: #f8f9fa;
                            padding: 80px 20px;
                            text-align: center;
                        }
                        .contact h2 {
                            color: #333;
                            margin-bottom: 2rem;
                        }
                        .contact-info {
                            display: flex;
                            justify-content: center;
                            gap: 3rem;
                            flex-wrap: wrap;
                            margin-top: 2rem;
                        }
                        .contact-item {
                            display: flex;
                            align-items: center;
                            gap: 1rem;
                            font-size: 1.1rem;
                        }
                        .contact-item i {
                            color: #667eea;
                            font-size: 1.5rem;
                        }
                        .editable {
                            transition: all 0.3s ease;
                            cursor: pointer;
                            position: relative;
                            border-radius: 4px;
                        }
                        .editable:hover {
                            outline: 2px dashed rgba(102, 126, 234, 0.5);
                            background: rgba(102, 126, 234, 0.05) !important;
                        }
                        .editable.selected {
                            outline: 3px solid #667eea !important;
                            background: rgba(102, 126, 234, 0.1) !important;
                        }
                        .editable[contenteditable="true"] {
                            outline: 3px solid #26de81 !important;
                            background: rgba(38, 222, 129, 0.1) !important;
                        }
                    </style>
                </head>
                <body>
                    <section class="hero">
                        <h1 class="editable" data-type="text">${website.name}</h1>
                        <p class="editable" data-type="text">מומחה ב${website.category} עם ניסיון רב שנים ושירות מקצועי ואמין</p>
                        <a href="#contact" class="cta-button editable" data-type="text">יצירת קשר</a>
                    </section>

                    <section class="section">
                        <h2 class="editable" data-type="text">השירותים שלנו</h2>
                        <div class="services">
                            <div class="service">
                                <h3 class="editable" data-type="text">שירות מקצועי</h3>
                                <p class="editable" data-type="text">תיאור מפורט של השירות הראשון שאנו מציעים עם כל הפרטים החשובים</p>
                            </div>
                            <div class="service">
                                <h3 class="editable" data-type="text">ייעוץ אישי</h3>
                                <p class="editable" data-type="text">ייעוץ מותאם אישית לצרכים שלכם עם מעקב צמוד והכוונה מקצועית</p>
                            </div>
                            <div class="service">
                                <h3 class="editable" data-type="text">שירות VIP</h3>
                                <p class="editable" data-type="text">שירות פרמיום עם זמינות מלאה ויחס אישי למען שביעות רצונכם</p>
                            </div>
                        </div>
                    </section>

                    <section class="contact" id="contact">
                        <h2 class="editable" data-type="text">צור קשר</h2>
                        <p class="editable" data-type="text">נשמח לענות על כל שאלה ולתת ייעוץ מקצועי</p>
                        <div class="contact-info">
                            <div class="contact-item">
                                <i class="fas fa-phone"></i>
                                <span class="editable" data-type="text">052-1234567</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-envelope"></i>
                                <span class="editable" data-type="text">info@example.com</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span class="editable" data-type="text">תל אביב, ישראל</span>
                            </div>
                        </div>
                    </section>
                </body>
                </html>
            `;
        }

        function loadDefaultWebsite() {
            // Load first website by default
            const firstWebsite = Object.keys(websites)[0];
            document.getElementById('websiteSelector').value = firstWebsite;
            loadWebsite(firstWebsite);
        }

        // Editable Elements Setup
        function setupEditableElements() {
            const frame = document.getElementById('previewFrame');
            if (!frame.contentDocument) return;

            const editableElements = frame.contentDocument.querySelectorAll('.editable');
            
            editableElements.forEach(element => {
                element.addEventListener('click', function(e) {
                    e.stopPropagation();
                    selectElement(this);
                });

                element.addEventListener('dblclick', function(e) {
                    e.stopPropagation();
                    if (this.dataset.type === 'text') {
                        this.contentEditable = true;
                        this.focus();
                        selectText(this);
                    }
                });

                element.addEventListener('blur', function() {
                    this.contentEditable = false;
                    saveCurrentState();
                });

                element.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.blur();
                    }
                });
            });

            // Click outside to deselect
            frame.contentDocument.addEventListener('click', function(e) {
                if (!e.target.classList.contains('editable')) {
                    deselectElement();
                }
            });
        }

        function selectElement(element) {
            deselectElement();
            selectedElement = element;
            element.classList.add('selected');
            updatePropertiesPanel(element);
        }

        function deselectElement() {
            if (selectedElement) {
                selectedElement.classList.remove('selected');
                selectedElement = null;
            }
        }

        function selectText(element) {
            const range = document.createRange();
            range.selectNodeContents(element);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
        }

        function updatePropertiesPanel(element) {
            const computedStyle = window.getComputedStyle(element);
            
            // Update text input
            document.getElementById('elementText').value = element.textContent;
            
            // Update font family
            document.getElementById('fontFamily').value = computedStyle.fontFamily.split(',')[0].replace(/'/g, '');
            
            // Update font size
            const fontSize = parseInt(computedStyle.fontSize);
            document.getElementById('fontSize').value = fontSize;
            document.getElementById('fontSizeValue').textContent = fontSize + 'px';
            
            // Update colors
            document.getElementById('textColor').value = rgbToHex(computedStyle.color);
            document.getElementById('bgColor').value = rgbToHex(computedStyle.backgroundColor);
            
            // Update spacing
            const padding = parseInt(computedStyle.padding) || 0;
            document.getElementById('padding').value = padding;
            document.getElementById('paddingValue').textContent = padding + 'px';
        }

        // Helper Functions
        function rgbToHex(rgb) {
            if (!rgb || rgb === 'rgba(0, 0, 0, 0)') return '#ffffff';
            
            const rgbMatch = rgb.match(/\d+/g);
            if (!rgbMatch) return '#000000';
            
            const r = parseInt(rgbMatch[0]);
            const g = parseInt(rgbMatch[1]);
            const b = parseInt(rgbMatch[2]);
            
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        // Element Updates
        function updateElementText(value) {
            if (selectedElement) {
                selectedElement.textContent = value;
                saveCurrentState();
            }
        }

        function updateElementLink(value) {
            if (selectedElement && selectedElement.tagName === 'A') {
                selectedElement.href = value;
                saveCurrentState();
            }
        }

        function updateFontFamily(value) {
            if (selectedElement) {
                selectedElement.style.fontFamily = value;
                saveCurrentState();
            }
        }

        function updateFontSize(value) {
            if (selectedElement) {
                selectedElement.style.fontSize = value + 'px';
                document.getElementById('fontSizeValue').textContent = value + 'px';
                saveCurrentState();
            }
        }

        function toggleFontWeight(weight) {
            if (selectedElement) {
                selectedElement.style.fontWeight = selectedElement.style.fontWeight === weight ? 'normal' : weight;
                saveCurrentState();
            }
        }

        function toggleFontStyle(style) {
            if (selectedElement) {
                selectedElement.style.fontStyle = selectedElement.style.fontStyle === style ? 'normal' : style;
                saveCurrentState();
            }
        }

        function updateTextColor(color) {
            if (selectedElement) {
                selectedElement.style.color = color;
                saveCurrentState();
            }
        }

        function updateBgColor(color) {
            if (selectedElement) {
                selectedElement.style.backgroundColor = color;
                saveCurrentState();
            }
        }

        function updateBorderColor(color) {
            if (selectedElement) {
                selectedElement.style.borderColor = color;
                saveCurrentState();
            }
        }

        function updatePadding(value) {
            if (selectedElement) {
                selectedElement.style.padding = value + 'px';
                document.getElementById('paddingValue').textContent = value + 'px';
                saveCurrentState();
            }
        }

        function updateMargin(value) {
            if (selectedElement) {
                selectedElement.style.margin = value + 'px';
                document.getElementById('marginValue').textContent = value + 'px';
                saveCurrentState();
            }
        }

        function updateBorderWidth(value) {
            if (selectedElement) {
                selectedElement.style.borderWidth = value + 'px';
                selectedElement.style.borderStyle = 'solid';
                document.getElementById('borderWidthValue').textContent = value + 'px';
                saveCurrentState();
            }
        }

        function updateBorderRadius(value) {
            if (selectedElement) {
                selectedElement.style.borderRadius = value + 'px';
                document.getElementById('borderRadiusValue').textContent = value + 'px';
                saveCurrentState();
            }
        }

        function updateOpacity(value) {
            if (selectedElement) {
                selectedElement.style.opacity = value / 100;
                document.getElementById('opacityValue').textContent = value + '%';
                saveCurrentState();
            }
        }

        function toggleShadow(type) {
            if (!selectedElement) return;
            
            switch(type) {
                case 'none':
                    selectedElement.style.boxShadow = 'none';
                    break;
                case 'small':
                    selectedElement.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                    break;
                case 'large':
                    selectedElement.style.boxShadow = '0 10px 30px rgba(0,0,0,0.2)';
                    break;
            }
            saveCurrentState();
        }

        // Device Controls
        function setDevice(device) {
            currentDevice = device;
            
            // Update button states
            document.querySelectorAll('.device-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update canvas
            const canvas = document.getElementById('canvasContainer');
            canvas.className = `canvas-container ${device}`;
            
            showNotification(`מעבר למצב ${device === 'desktop' ? 'מחשב' : device === 'tablet' ? 'טאבלט' : 'מובייל'}`, 'info');
        }

        function updateZoom(value) {
            zoomLevel = value;
            document.getElementById('zoomValue').textContent = value + '%';
            
            const canvas = document.getElementById('canvasContainer');
            canvas.style.transform = `scale(${value / 100})`;
        }

        // Components
        function addComponent(type) {
            if (!currentWebsite) {
                showNotification('בחר אתר תחילה', 'warning');
                return;
            }

            showNotification(`מוסיף רכיב: ${type}`, 'info');
            
            const frame = document.getElementById('previewFrame');
            if (!frame.contentDocument) return;

            let newElement;
            
            switch(type) {
                case 'text':
                    newElement = frame.contentDocument.createElement('p');
                    newElement.className = 'editable';
                    newElement.dataset.type = 'text';
                    newElement.textContent = 'טקסט חדש - לחץ כפול לעריכה';
                    newElement.style.cssText = 'padding: 20px; margin: 10px; font-size: 16px; color: #333;';
                    break;
                    
                case 'hero':
                    newElement = frame.contentDocument.createElement('section');
                    newElement.className = 'hero editable';
                    newElement.dataset.type = 'section';
                    newElement.innerHTML = `
                        <h1 class="editable" data-type="text">כותרת ראשית</h1>
                        <p class="editable" data-type="text">תיאור קצר ומרשים</p>
                        <button class="cta-button editable" data-type="text">פעולה</button>
                    `;
                    break;
                    
                case 'image':
                    newElement = frame.contentDocument.createElement('img');
                    newElement.className = 'editable';
                    newElement.dataset.type = 'image';
                    newElement.src = 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=600&h=400&fit=crop';
                    newElement.alt = 'תמונה';
                    newElement.style.cssText = 'width: 100%; max-width: 600px; height: auto; border-radius: 10px; margin: 20px 0;';
                    break;
                    
                case 'button':
                    newElement = frame.contentDocument.createElement('button');
                    newElement.className = 'cta-button editable';
                    newElement.dataset.type = 'text';
                    newElement.textContent = 'כפתור חדש';
                    break;
                    
                default:
                    showNotification(`רכיב ${type} יפותח בגרסה הבאה`, 'info');
                    return;
            }
            
            // Add to body
            frame.contentDocument.body.appendChild(newElement);
            
            // Setup editable
            setupEditableElements();
            
            // Select new element
            selectElement(newElement);
            
            showNotification(`רכיב ${type} נוסף בהצלחה!`, 'success');
        }

        // Pages Management
        function addNewPage() {
            const pageName = prompt('שם הדף החדש:');
            if (!pageName) return;
            
            const pagesList = document.getElementById('pagesList');
            const newPage = document.createElement('div');
            newPage.className = 'page-item';
            newPage.innerHTML = `
                <span>${pageName}</span>
                <div class="page-controls">
                    <button title="ערוך"><i class="fas fa-edit"></i></button>
                    <button title="שכפל"><i class="fas fa-copy"></i></button>
                    <button title="מחק"><i class="fas fa-trash"></i></button>
                </div>
            `;
            
            pagesList.appendChild(newPage);
            showNotification(`דף "${pageName}" נוסף בהצלחה!`, 'success');
        }

        // Media Management
        function uploadMedia() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,video/*';
            input.multiple = true;
            
            input.onchange = function(e) {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            addMediaItem(file.name, e.target.result, 'image');
                        };
                        reader.readAsDataURL(file);
                    }
                });
                showNotification(`${files.length} קבצים הועלו בהצלחה!`, 'success');
            };
            
            input.click();
        }

        function addMediaItem(name, src, type) {
            const mediaGrid = document.getElementById('mediaGrid');
            const mediaItem = document.createElement('div');
            mediaItem.className = 'media-item';
            mediaItem.onclick = () => selectMedia(name);
            
            if (type === 'image') {
                mediaItem.innerHTML = `
                    <img src="${src}" alt="${name}">
                    <small>${name}</small>
                `;
            }
            
            mediaGrid.appendChild(mediaItem);
        }

        function selectMedia(mediaId) {
            if (selectedElement && selectedElement.tagName === 'IMG') {
                selectedElement.src = `https://images.unsplash.com/photo-${Math.random().toString(36).substr(2, 9)}?w=600&h=400&fit=crop`;
                showNotification('תמונה הוחלפה בהצלחה!', 'success');
                saveCurrentState();
            } else {
                showNotification('בחר תמונה באתר תחילה', 'warning');
            }
        }

        // AI Functions
        function toggleAI() {
            aiActive = !aiActive;
            const aiChat = document.getElementById('aiChat');
            aiChat.classList.toggle('active', aiActive);
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            if (!message) return;
            
            const messagesContainer = document.getElementById('aiMessages');
            
            // Add user message
            const userMessage = document.createElement('div');
            userMessage.style.cssText = 'background: #667eea; color: white; padding: 10px; border-radius: 8px; margin-bottom: 10px; text-align: right;';
            userMessage.textContent = message;
            messagesContainer.appendChild(userMessage);
            
            // Add AI response
            setTimeout(() => {
                const aiResponse = document.createElement('div');
                aiResponse.style.cssText = 'background: #f0f0f0; padding: 10px; border-radius: 8px; margin-bottom: 10px;';
                aiResponse.textContent = getAIResponse(message);
                messagesContainer.appendChild(aiResponse);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 1000);
            
            input.value = '';
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function getAIResponse(message) {
            const responses = [
                'זה רעיון מעולה! בואו נוסיף את זה לאתר.',
                'אני ממליץ לשנות את הצבעים להרמוניה יותר טובה.',
                'תוכל להוסיף גלריית תמונות כאן, זה יעשה רושם!',
                'הטקסט הזה מושלם - רק צריך להדגיש אותו יותר.',
                'בואו נוסיף אנימציה עדינה לרכיב הזה.',
                'אני חושב שכפתור קריאה לפעולה כאן יהיה מעולה.',
                'החלק הזה נראה טוב, אבל אפשר לשפר את הרווחים.',
                'מה דעתך להוסיף סקציית המלצות לקוחות?',
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function aiOptimize() {
            showLoading(true);
            setTimeout(() => {
                showLoading(false);
                showNotification('AI ביצע אופטימיזציה למהירות וביצועים!', 'success');
            }, 2000);
        }

        function aiGenerateContent() {
            if (!selectedElement) {
                showNotification('בחר אלמנט טקסט תחילה', 'warning');
                return;
            }
            
            const suggestions = [
                'שירות מקצועי ואמין עם ניסיון של שנים רבות בתחום',
                'פתרונות מותאמים אישית לכל לקוח ולקוח',
                'צוות מומחים עם הכשרה מתקדמת ושירות ברמה הגבוהה ביותר',
                'יעילות מקסימלית ותוצאות מדהימות בזמן הקצר ביותר',
                'שביעות רצון מלאה מובטחת עם אחריות מלאה על השירות'
            ];
            
            const newContent = suggestions[Math.floor(Math.random() * suggestions.length)];
            selectedElement.textContent = newContent;
            document.getElementById('elementText').value = newContent;
            
            showNotification('AI יצר תוכן חדש!', 'success');
            saveCurrentState();
        }

        function aiColorScheme() {
            const colors = [
                ['#667eea', '#764ba2'], // Purple
                ['#f093fb', '#f5576c'], // Pink
                ['#4facfe', '#00f2fe'], // Blue
                ['#43e97b', '#38f9d7'], // Green
                ['#fa709a', '#fee140'], // Orange
                ['#a8edea', '#fed6e3'], // Pastel
                ['#667db6', '#0082c8'], // Professional
                ['#ff9a9e', '#fecfef']  // Soft
            ];
            
            const selectedColors = colors[Math.floor(Math.random() * colors.length)];
            
            if (selectedElement) {
                selectedElement.style.background = `linear-gradient(45deg, ${selectedColors[0]}, ${selectedColors[1]})`;
                selectedElement.style.color = 'white';
                showNotification('AI יצר ערכת צבעים חדשה!', 'success');
                saveCurrentState();
            } else {
                showNotification('בחר אלמנט תחילה', 'warning');
            }
        }

        // Save/Load System
        function saveCurrentState() {
            if (!currentWebsite) return;
            
            const frame = document.getElementById('previewFrame');
            if (frame.contentDocument) {
                const state = {
                    website: currentWebsite,
                    html: frame.contentDocument.documentElement.outerHTML,
                    timestamp: Date.now()
                };
                
                undoStack.push(state);
                redoStack = []; // Clear redo stack
                
                // Limit undo stack size
                if (undoStack.length > 50) {
                    undoStack.shift();
                }
            }
        }

        function undoAction() {
            if (undoStack.length > 1) {
                const currentState = undoStack.pop();
                redoStack.push(currentState);
                
                const previousState = undoStack[undoStack.length - 1];
                restoreState(previousState);
                
                showNotification('פעולה בוטלה', 'info');
            } else {
                showNotification('אין פעולות לביטול', 'warning');
            }
        }

        function redoAction() {
            if (redoStack.length > 0) {
                const state = redoStack.pop();
                undoStack.push(state);
                restoreState(state);
                
                showNotification('פעולה שוחזרה', 'info');
            } else {
                showNotification('אין פעולות לשחזור', 'warning');
            }
        }

        function restoreState(state) {
            const frame = document.getElementById('previewFrame');
            frame.srcdoc = state.html;
            frame.onload = function() {
                setupEditableElements();
            };
        }

        function autoSave() {
            if (currentWebsite) {
                saveProject(true);
            }
        }

        function saveProject(isAuto = false) {
            if (!currentWebsite) {
                showNotification('אין אתר לשמירה', 'warning');
                return;
            }
            
            showLoading(true);
            
            setTimeout(() => {
                const frame = document.getElementById('previewFrame');
                const html = frame.contentDocument ? frame.contentDocument.documentElement.outerHTML : '';
                
                // Save to localStorage (in real app, save to server)
                localStorage.setItem(`website_${currentWebsite}`, html);
                localStorage.setItem(`website_${currentWebsite}_timestamp`, Date.now());
                
                showLoading(false);
                
                if (!isAuto) {
                    showNotification('הפרויקט נשמר בהצלחה!', 'success');
                }
            }, 1000);
        }

        function publishSite() {
            if (!currentWebsite) {
                showNotification('בחר אתר תחילה', 'warning');
                return;
            }
            
            showLoading(true);
            
            setTimeout(() => {
                showLoading(false);
                showNotification('האתר פורסם בהצלחה! זמין בכתובת: example.com', 'success');
            }, 3000);
        }

        function previewSite() {
            if (!currentWebsite) {
                showNotification('בחר אתר תחילה', 'warning');
                return;
            }
            
            const frame = document.getElementById('previewFrame');
            if (frame.contentDocument) {
                const html = frame.contentDocument.documentElement.outerHTML;
                const blob = new Blob([html], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                window.open(url, '_blank');
                showNotification('תצוגה מקדימה נפתחה', 'info');
            }
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notificationText');
            
            text.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        function showLoading(show) {
            const loading = document.getElementById('loading');
            loading.classList.toggle('show', show);
        }

        // Keyboard Shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveProject();
                        break;
                    case 'z':
                        e.preventDefault();
                        if (e.shiftKey) {
                            redoAction();
                        } else {
                            undoAction();
                        }
                        break;
                }
            }
        });

        // Console message
        console.log('🚀 WebMaster Pro Ultimate Editor initialized!');
        console.log('💎 Features: Visual Editor, AI Assistant, Media Manager, 11 Professional Websites');
        console.log('💰 Total Value: ₪26,900');
    </script>
</body>
</html>
