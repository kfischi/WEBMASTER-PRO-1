<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>WebMaster Pro AI Editor</title>
  <style>
    :root {
      --primary: #4f46e5;
      --glass-border: rgba(255,255,255,0.2);
    }
    * { box-sizing: border-box; margin:0; padding:0; }
    body { font-family: sans-serif; display: grid; grid-template-columns:180px 1fr 200px; height:100vh; overflow:hidden; }
    aside { background: #111; color:#fff; padding:1rem; overflow:auto; }
    main { background:#fafafa; position:relative; }

    #canvas-content {
      width:100%; height:100%; padding:1rem; overflow:auto;
      background:#fff; transition:all .3s;
    }
    #canvas-content.drag-over {
      outline:2px dashed var(--primary);
    }
    .draggable {
      position:relative; border:1px dashed transparent;
    }
    .draggable.dragging {
      opacity:0.5;
    }

    .blocks-list .block-item {
      display:flex; align-items:center; gap:.5rem;
      padding:.5rem; margin-bottom:.5rem;
      border:1px solid var(--glass-border); border-radius:4px;
      background:rgba(255,255,255,0.1); cursor:grab;
      transition:all .2s;
    }
    .blocks-list .block-item:active { cursor:grabbing; }
    .blocks-list .block-item:hover {
      background:rgba(255,255,255,0.2);
      transform:translateX(-2px);
    }

    .tool-btn {
      width:100%; padding:.75rem; margin-bottom:.5rem;
      background:var(--primary); color:#fff; border:none; border-radius:.5rem;
      cursor:pointer; transition:all .3s;
    }
    .tool-btn:hover { transform:translateY(-2px); box-shadow:0 4px 15px rgba(79,70,229,0.4); }

    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
    @keyframes slideInLeft { from{transform:translateX(-100%);} to{transform:translateX(0);} }
    @keyframes bounce { 0%,20%,50%,80%,to{transform:translateY(0);} 40%,60%{transform:translateY(-30px);} }
    @keyframes pulse { 0%{transform:scale(1);} 50%{transform:scale(1.05);} 100%{transform:scale(1);} }

    .notification {
      position:fixed; top:1rem; left:50%; transform:translateX(-50%);
      background:var(--primary); color:#fff; padding:1rem 2rem; border-radius:8px;
      animation:fadeIn 0.5s ease, fadeOut 0.5s ease 2.5s;
    }
    @keyframes fadeOut { from{opacity:1;} to{opacity:0;} }
  </style>
</head>
<body>
  <aside>
    <h3>ğŸ”§ ×‘×œ×•×§×™×</h3>
    <div class="blocks-list"></div>
    <hr>
    <div class="advanced-tools">
      <h3>ğŸ¨ ×›×œ×™× ××ª×§×“××™×</h3>
      <button onclick="magicDesign()" class="tool-btn">âœ¨ Magic Design</button>
      <button onclick="openVideoEditor()" class="tool-btn">ğŸ¬ ×¢×¨×™×›×ª ×•×™×“××•</button>
      <button onclick="optimizeWebsite()" class="tool-btn">âš¡ ××•×¤×˜×™××™×–×¦×™×”</button>
      <button onclick="generateSEO()" class="tool-btn">ğŸ“ˆ SEO ××•×˜×•××˜×™</button>
    </div>
  </aside>
  <main>
    <div id="canvas-content"></div>
  </main>
  <aside>
    <h3>ğŸ” ×××¤×™×™× ×™×</h3>
    <div class="property-section">
      <h3>×× ×™××¦×™×•×ª</h3>
      <select onchange="addAnimation(this.value)">
        <option value="">×‘×—×¨ ×× ×™××¦×™×”</option>
        <option value="fadeIn">Fade In</option>
        <option value="slideInLeft">Slide In</option>
        <option value="bounce">Bounce</option>
        <option value="pulse">Pulse</option>
      </select>
    </div>
    <div class="property-section">
      <h3>ğŸ“± ×¨×¡×¤×•× ×¡×™×‘×™×•×ª</h3>
      <button onclick="previewMobile()" class="tool-btn">ğŸ“± ××•×‘×™×™×œ</button>
      <button onclick="previewTablet()" class="tool-btn">ğŸ“± ×˜××‘×œ×˜</button>
      <button onclick="previewDesktop()" class="tool-btn">ğŸ’» ×“×¡×§×˜×•×¤</button>
    </div>
  </aside>

  <div id="video-editor-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:2000;">
    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#222; color:#fff; padding:2rem; border-radius:1rem; width:80%; height:80%; overflow:auto;">
      <h2>ğŸ¬ ×¢×¨×™×›×ª ×•×™×“××•</h2>
      <input type="file" accept="video/*" onchange="handleVideoUpload(this.files[0])"><br><br>
      <div style="position:relative;">
        <video id="video-preview" controls style="width:100%; max-height:300px;"></video>
      </div>
      <br>
      <button onclick="trimVideo()">âœ‚ï¸ ×—×ª×•×š</button>
      <button onclick="addVideoText()">ğŸ“ ×”×•×¡×£ ×˜×§×¡×˜</button>
      <button onclick="exportVideo()">ğŸ’¾ ×™×™×¦×</button>
      <button onclick="closeVideoEditor()">âŒ ×¡×’×•×¨</button>
    </div>
  </div>

  <script>
    // ×¨×©×™××ª ×”××ª×¨×™× ×”××œ××”
    const websites = [
      {id:'dr-michal-rosen', name:'×“"×¨ ××™×›×œ ×¨×•×–×Ÿ', url:'./websites/dr-michal-rosen.html', image:'https://i.imghippo.com/files/Ayyb2287TOc.png', category:'medical', price:'â‚ª2,800'},
      {id:'fitness-co', name:'×“× ×™ ×¤×™×˜', url:'./websites/fitness-co.html', image:'https://i.imghippo.com/files/WiRp8302YJs.png', category:'lifestyle', price:'â‚ª2,200'},
      {id:'yoga-studio', name:'×¡×˜×•×“×™×• ××•×”×', url:'./websites/yoga-studio.html', image:'https://i.imghippo.com/files/eJk7179MXo.png', category:'lifestyle', price:'â‚ª1,900'},
      {id:'nutritionist', name:'×“"×¨ ×©×¨×” ×›×”×Ÿ', url:'./websites/nutritionist.html', image:'https://i.imghippo.com/files/rhNp2418oyE.png', category:'medical', price:'â‚ª2,400'},
      {id:'law-firm', name:'××©×¨×“ ×‘×¨×§×•×‘×™×¥', url:'./websites/law-firm.html', image:'https://i.imghippo.com/files/hVyV3858OQ.png', category:'business', price:'â‚ª2,500'},
      {id:'accountant', name:'×¨×™× ×” ×œ×•×™', url:'./websites/accountant.html', image:'https://i.imghippo.com/files/tGN5433dAU.png', category:'business', price:'â‚ª2,000'},
      {id:'beauty-salon', name:'××¡×¤×¨×” BELLA', url:'./websites/beauty-salon.html', image:'https://i.imghippo.com/files/xnK4816Hc.png', category:'lifestyle', price:'â‚ª1,700'},
      {id:'tutor', name:'×“"×¨ ×¨×•× ×™×ª ×œ×•×™', url:'./websites/tutor.html', image:'https://i.imghippo.com/files/Ceu2132Q.png', category:'education', price:'â‚ª2,100'},
      {id:'aesthetic-clinic', name:'×§×œ×™× ×™×§×ª ×™×•×¤×™ ×¤×¨××™×•×', url:'./websites/aesthetic-clinic.html', image:'https://i.imghippo.com/files/sWlf1880WKM.png', category:'premium', price:'â‚ª3,200'},
      {id:'multibrawn', name:'××•×œ×˜×™×‘×¨××•×Ÿ', url:'./websites/multibrawn.html', image:'https://i.imghippo.com/files/pL5530Z.png', category:'lifestyle', price:'â‚ª2,300'},
      {id:'real-estate', name:'× ×“×œ"×Ÿ ×¤×¨××™×•×', url:'./websites/real-estate.html', image:'https://i.imghippo.com/files/htWG9491QkE.png', category:'premium', price:'â‚ª2,700'}
    ];

    // ×˜×¢×™× ×ª ××ª×¨ ×™×©×™×¨×”
    async function loadWebsiteDirectly(id) {
      const site = websites.find(w=>w.id===id);
      try {
        const res = await fetch(site.url);
        const html = await res.text();
        const canvas = document.getElementById('canvas-content');
        canvas.innerHTML = html;
        canvas.querySelectorAll('h1,h2,h3,p,span,div').forEach(el=>{
          el.contentEditable = true;
          makeElementDraggable(el);
          el.addEventListener('click',()=> selectElement(el));
          el.addEventListener('input',()=> saveChanges());
        });
        showNotification('××ª×¨ × ×˜×¢×Ÿ - ×¢×¨×™×›×” ×–××™× ×”!');
      } catch (e) { showNotification('×©×’×™××” ×‘×˜×¢×™× ×ª ×”××ª×¨', 'error'); }
    }

    // VideoEditor ××œ××”
    class VideoEditor {
      constructor(){
        this.videoElement = document.getElementById('video-preview');
        this.startTime=0; this.endTime=0;
      }
      handleVideoUpload(file){
        if(!file||!file.type.startsWith('video/')){ showNotification('×‘×—×¨ ×•×™×“××• ×ª×§×™×Ÿ','error'); return; }
        this.videoElement.src=URL.createObjectURL(file);
        this.videoElement.onloadedmetadata=()=>{
          this.endTime=this.videoElement.duration;
          showNotification(`×•×™×“××• ×”×•×¢×œ×” (${Math.round(this.endTime)}s)`);
        };
      }
      trimVideo(){
        const start=parseFloat(prompt('×©× ×™×™×” ×”×ª×—×œ×”:')||0);
        const end=parseFloat(prompt('×©× ×™×™×” ×¡×™×•×:')||this.videoElement.duration);
        if(start<end&&end<=this.videoElement.duration){ this.startTime=start; this.endTime=end; this.videoElement.currentTime=start;
          showNotification(`×•×™×“××• × ×—×ª×š ${start}-${end}s`);
        } else showNotification('×–×× ×™× ×œ× ×ª×§×™× ×™×','error');
      }
      addVideoText(){
        const text=prompt('×˜×§×¡×˜:'); const x=parseInt(prompt('X(0-100):')||50); const y=parseInt(prompt('Y(0-100):')||50);
        if(text){ const ov=document.createElement('div');
          ov.style.cssText=`position:absolute;top:${y}%;left:${x}%;color:white;font-size:24px;font-weight:bold;`
