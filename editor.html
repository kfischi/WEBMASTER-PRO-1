<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebMaster Pro - אדיטור ויזואלי מתקדם</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #26de81;
            --warning: #fed330;
            --danger: #ff3838;
            --info: #4facfe;
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #6c757d;
            --border: #e1e5e9;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            height: 100vh;
            overflow: hidden;
            color: var(--text-primary);
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow);
            z-index: 1000;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            width: 45px;
            height: 45px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .logo-text {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
        }

        .website-selector {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 12px 20px;
            font-size: 15px;
            min-width: 350px;
            outline: none;
            transition: all 0.3s ease;
        }

        .website-selector:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn.success {
            background: linear-gradient(45deg, var(--success), #20bf6b);
        }

        .btn.warning {
            background: linear-gradient(45deg, var(--warning), #f7b733);
        }

        .btn.danger {
            background: linear-gradient(45deg, var(--danger), #c44569);
        }

        /* Main Layout */
        .main-container {
            display: flex;
            height: calc(100vh - 80px);
        }

        /* Left Panel */
        .left-panel {
            width: 320px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow);
        }

        .panel-tabs {
            display: flex;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
        }

        .panel-tab {
            flex: 1;
            padding: 15px 10px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            text-align: center;
        }

        .panel-tab.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        .panel-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .section {
            margin-bottom: 25px;
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .section-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--primary);
            font-size: 18px;
        }

        /* Website Info */
        .website-info {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .info-row:last-child {
            margin-bottom: 0;
        }

        .info-label {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .info-value {
            color: var(--text-primary);
            font-weight: 700;
        }

        .price-tag {
            background: linear-gradient(45deg, var(--success), #20bf6b);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
        }

        /* Advanced Tools Grid */
        .tools-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .tool-btn {
            background: var(--bg-primary);
            border: 2px solid var(--border);
            padding: 15px 10px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .tool-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .tool-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tool-btn i {
            font-size: 20px;
            margin-bottom: 8px;
            display: block;
        }

        /* Color Picker Advanced */
        .color-palette {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 5px;
            margin-bottom: 15px;
        }

        .color-swatch {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .color-swatch:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .color-swatch.active {
            border-color: var(--primary);
            transform: scale(1.1);
        }

        /* Center Area */
        .center-area {
            flex: 1;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
        }

        .toolbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
        }

        .device-controls {
            display: flex;
            gap: 8px;
            background: var(--bg-primary);
            padding: 5px;
            border-radius: 10px;
        }

        .device-btn {
            background: transparent;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .device-btn.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .toolbar-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .zoom-control {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .zoom-slider {
            width: 100px;
            height: 6px;
            border-radius: 3px;
            background: var(--bg-primary);
            outline: none;
            cursor: pointer;
        }

        .canvas-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: hidden;
            position: relative;
        }

        .website-frame {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
            transition: all 0.5s ease;
            border: 1px solid rgba(255,255,255,0.2);
            position: relative;
        }

        .website-frame.desktop {
            width: 1200px;
            height: 800px;
        }

        .website-frame.tablet {
            width: 768px;
            height: 1024px;
        }

        .website-frame.mobile {
            width: 375px;
            height: 667px;
        }

        .website-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .frame-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
            border-radius: 15px;
        }

        .frame-overlay.edit-mode {
            pointer-events: all;
            background: rgba(0,0,0,0.02);
        }

        .placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 500px;
            color: var(--text-secondary);
            text-align: center;
        }

        .placeholder i {
            font-size: 64px;
            color: var(--primary);
            margin-bottom: 20px;
            opacity: 0.6;
        }

        .placeholder h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        /* Right Panel */
        .right-panel {
            width: 320px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow);
        }

        .properties-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
            background: white;
        }

        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .color-input {
            width: 100%;
            height: 45px;
            padding: 5px;
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            background: white;
        }

        .range-input {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--bg-primary);
            outline: none;
            cursor: pointer;
        }

        .range-value {
            font-size: 12px;
            color: var(--primary);
            font-weight: 600;
        }

        /* Advanced Style Controls */
        .style-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .style-btn {
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .style-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .style-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* AI Assistant */
        .ai-assistant {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 350px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            z-index: 2000;
            transform: translateY(400px);
            transition: all 0.4s ease;
        }

        .ai-assistant.open {
            transform: translateY(0);
        }

        .ai-header {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .ai-toggle {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 2001;
        }

        .ai-toggle:hover {
            transform: scale(1.1);
        }

        .ai-content {
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .ai-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            outline: none;
            margin-bottom: 10px;
        }

        .ai-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }

        .suggestion-chip {
            background: var(--bg-primary);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .suggestion-chip:hover {
            background: var(--primary);
            color: white;
        }

        /* Status Bar */
        .status-bar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-top: 1px solid var(--border);
            font-size: 13px;
        }

        .status-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
        }

        .status-indicator.loading {
            background: var(--warning);
            animation: pulse 1s infinite;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            border-radius: var(--radius);
            padding: 15px 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            transform: translateX(400px);
            transition: all 0.4s ease;
            z-index: 2000;
            border-left: 4px solid var(--primary);
            max-width: 320px;
            min-width: 280px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left-color: var(--success);
        }

        .notification.warning {
            border-left-color: var(--warning);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification-icon {
            font-size: 18px;
        }

        .notification-text {
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Loading States */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            border-radius: 15px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--bg-primary);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1400px) {
            .left-panel, .right-panel {
                width: 280px;
            }
            
            .website-frame.desktop {
                width: 1000px;
                height: 700px;
            }
        }

        @media (max-width: 1200px) {
            .main-container {
                flex-wrap: wrap;
            }
            
            .left-panel, .right-panel {
                width: 100%;
                height: 250px;
                order: 2;
            }
            
            .center-area {
                width: 100%;
                order: 1;
                height: calc(100vh - 330px);
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .website-selector {
                min-width: 100%;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo-section">
            <div class="logo-icon">
                <i class="fas fa-magic"></i>
            </div>
            <div class="logo-text">WebMaster Pro</div>
        </div>

        <select class="website-selector" id="websiteSelector">
            <option value="">בחר אתר לעריכה (11 אתרים זמינים)</option>
            <option value="dr-michal-rosen" data-price="2800" data-category="רפואה אסתטית">ד"ר מיכל רוזן - רפואה אסתטית (₪2,800)</option>
            <option value="fitness-coach" data-price="2200" data-category="מאמן כושר">דני פיט - מאמן כושר (₪2,200)</option>
            <option value="yoga-studio" data-price="1900" data-category="יוגה ומדיטציה">סטודיו אוהם - יוגה ומדיטציה (₪1,900)</option>
            <option value="nutritionist" data-price="2400" data-category="תזונאית קלינית">ד"ר שרה כהן - תזונאית קלינית (₪2,400)</option>
            <option value="law-firm" data-price="2500" data-category="עורכי דין">משרד ברקוביץ - עורכי דין (₪2,500)</option>
            <option value="accountant" data-price="2000" data-category="חשבת שכר">רינה לוי - חשבת שכר (₪2,000)</option>
            <option value="beauty-salon" data-price="1700" data-category="יופי ועיצוב שיער">מספרה BELLA - יופי ועיצוב שיער (₪1,700)</option>
            <option value="tutor" data-price="2100" data-category="מורה פרטית">ד"ר רונית לוי - מורה פרטית (₪2,100)</option>
            <option value="aesthetic-clinic" data-price="3200" data-category="אסתטיקה רפואית">קליניקת יופי פרמיום - אסתטיקה רפואית (₪3,200) ⭐</option>
            <option value="multibrawn" data-price="2300" data-category="נופש ואירועים">מולטיבראון - נופש ואירועים (₪2,300)</option>
            <option value="real-estate" data-price="2700" data-category="נדל"ן יוקרה">נדל"ן פרמיום - נדל"ן יוקרה (₪2,700)</option>
        </select>

        <div class="header-actions">
            <button class="btn" onclick="undoChange()">
                <i class="fas fa-undo"></i>
                ביטול
            </button>
            <button class="btn" onclick="redoChange()">
                <i class="fas fa-redo"></i>
                חזרה
            </button>
            <button class="btn" onclick="saveWebsite()">
                <i class="fas fa-save"></i>
                שמירה
            </button>
            <button class="btn success" onclick="publishWebsite()">
                <i class="fas fa-rocket"></i>
                פרסום
            </button>
            <button class="btn warning" onclick="previewWebsite()">
                <i class="fas fa-eye"></i>
                תצוגה
            </button>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Panel -->
        <div class="left-panel">
            <div class="panel-tabs">
                <button class="panel-tab active" onclick="switchTab('design', this)">
                    <i class="fas fa-palette"></i>
                    עיצוב
                </button>
                <button class="panel-tab" onclick="switchTab('content', this)">
                    <i class="fas fa-edit"></i>
                    תוכן
                </button>
                <button class="panel-tab" onclick="switchTab('media', this)">
                    <i class="fas fa-images"></i>
                    מדיה
                </button>
            </div>

            <div class="panel-content" id="panelContent">
                <!-- Design Tab Content -->
                <div id="designTab">
                    <!-- Website Info Section -->
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-info-circle"></i>
                            פרטי האתר
                        </div>
                        <div class="website-info" id="websiteInfo">
                            <p style="color: var(--text-secondary); text-align: center;">בחר אתר מהרשימה העליונה לצפייה בפרטים</p>
                        </div>
                    </div>

                    <!-- Color Palette Section -->
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-palette"></i>
                            לוח צבעים
                        </div>
                        <div class="color-palette" id="colorPalette">
                            <div class="color-swatch" style="background: #667eea" onclick="selectColor('#667eea')"></div>
                            <div class="color-swatch" style="background: #764ba2" onclick="selectColor('#764ba2')"></div>
                            <div class="color-swatch" style="background: #4facfe" onclick="selectColor('#4facfe')"></div>
                            <div class="color-swatch" style="background: #00f2fe" onclick="selectColor('#00f2fe')"></div>
                            <div class="color-swatch" style="background: #43e97b" onclick="selectColor('#43e97b')"></div>
                            <div class="color-swatch" style="background: #38f9d7" onclick="selectColor('#38f9d7')"></div>
                            <div class="color-swatch" style="background: #fa709a" onclick="selectColor('#fa709a')"></div>
                            <div class="color-swatch" style="background: #fee140" onclick="selectColor('#fee140')"></div>
                            <div class="color-swatch" style="background: #ff3838" onclick="selectColor('#ff3838')"></div>
                            <div class="color-swatch" style="background: #2c3e50" onclick="selectColor('#2c3e50')"></div>
                            <div class="color-swatch" style="background: #ffffff" onclick="selectColor('#ffffff')"></div>
                            <div class="color-swatch" style="background: #000000" onclick="selectColor('#000000')"></div>
                        </div>
                        <input type="color" class="color-input" id="customColor" onchange="selectColor(this.value)" title="בחר צבע מותאם">
                    </div>

                    <!-- Advanced Tools Section -->
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-tools"></i>
                            כלי עיצוב מתקדמים
                        </div>
                        <div class="tools-grid">
                            <div class="tool-btn" onclick="enableAdvancedEdit()" id="editModeBtn">
                                <i class="fas fa-edit"></i>
                                מצב עריכה
                            </div>
                            <div class="tool-btn" onclick="toggleInspector()" id="inspectorBtn">
                                <i class="fas fa-search"></i>
                                בוחן אלמנטים
                            </div>
                            <div class="tool-btn" onclick="addSection()">
                                <i class="fas fa-plus-square"></i>
                                הוסף קטע
                            </div>
                            <div class="tool-btn" onclick="duplicateElement()">
                                <i class="fas fa-copy"></i>
                                שכפל אלמנט
                            </div>
                            <div class="tool-btn" onclick="dragDropMode()">
                                <i class="fas fa-arrows-alt"></i>
                                גרור ושחרר
                            </div>
                            <div class="tool-btn" onclick="responsiveMode()">
                                <i class="fas fa-mobile-alt"></i>
                                רספונסיבי
                            </div>
                        </div>
                    </div>

                    <!-- Typography Section -->
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-font"></i>
                            טיפוגרפיה
                        </div>
                        <div class="form-group">
                            <label class="form-label">פונט:</label>
                            <select class="form-control" id="fontFamily" onchange="applyFontFamily(this.value)">
                                <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif">Segoe UI</option>
                                <option value="'Heebo', sans-serif">Heebo</option>
                                <option value="'Rubik', sans-serif">Rubik</option>
                                <option value="'Open Sans', sans-serif">Open Sans</option>
                                <option value="'Assistant', sans-serif">Assistant</option>
                                <option value="'Noto Sans Hebrew', sans-serif">Noto Sans Hebrew</option>
                            </select>
                        </div>
                        <div class="style-grid">
                            <div class="style-btn" onclick="applyFontWeight('bold')" id="boldBtn">
                                <i class="fas fa-bold"></i> עבה
                            </div>
                            <div class="style-btn" onclick="applyFontStyle('italic')" id="italicBtn">
                                <i class="fas fa-italic"></i> נטוי
                            </div>
                            <div class="style-btn" onclick="applyTextDecoration('underline')" id="underlineBtn">
                                <i class="fas fa-underline"></i> קו תחתון
                            </div>
                            <div class="style-btn" onclick="applyTextTransform('uppercase')" id="uppercaseBtn">
                                <i class="fas fa-font"></i> אותיות גדולות
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Tab (hidden by default) -->
                <div id="contentTab" style="display: none;">
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-edit"></i>
                            עריכת תוכן
                        </div>
                        <p>פיצ'רי עריכת תוכן יתווספו כאן...</p>
                    </div>
                </div>

                <!-- Media Tab (hidden by default) -->
                <div id="mediaTab" style="display: none;">
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-images"></i>
                            ניהול מדיה
                        </div>
                        <p>פיצ'רי העלאת תמונות יתווספו כאן...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Center Area -->
        <div class="center-area">
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="device-controls">
                    <button class="device-btn active" onclick="setDevice('desktop')" id="desktopBtn">
                        <i class="fas fa-desktop"></i>
                        מחשב
                    </button>
                    <button class="device-btn" onclick="setDevice('tablet')" id="tabletBtn">
                        <i class="fas fa-tablet-alt"></i>
                        טאבלט
                    </button>
                    <button class="device-btn" onclick="setDevice('mobile')" id="mobileBtn">
                        <i class="fas fa-mobile-alt"></i>
                        מובייל
                    </button>
                </div>

                <div class="toolbar-actions">
                    <div class="zoom-control">
                        <span>זום:</span>
                        <input type="range" class="zoom-slider" min="25" max="200" value="100" onchange="updateZoom(this.value)" id="zoomSlider">
                        <span id="zoomValue" class="range-value">100%</span>
                    </div>
                    <button class="btn" onclick="resetZoom()">
                        <i class="fas fa-search"></i>
                        איפוס זום
                    </button>
                </div>
            </div>

            <!-- Canvas -->
            <div class="canvas-container">
                <div class="website-frame desktop" id="websiteFrame">
                    <div class="placeholder" id="placeholder">
                        <i class="fas fa-rocket"></i>
                        <h3>WebMaster Pro מתקדם מוכן לעבודה!</h3>
                        <p>בחר אתר מהרשימה העליונה להתחלת עריכה מקצועית</p>
                        <p style="margin-top: 15px; color: var(--primary); font-weight: 600;">
                            11 אתרים ברמה עולמית | שווי כולל: ₪26,900
                        </p>
                        <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; font-size: 13px; line-height: 1.6;">
                            <strong>🚀 פיצ'רים חדשים:</strong><br>
                            ✅ עריכה בזמן אמת<br>
                            ✅ AI Assistant חכם<br>
                            ✅ כלי עיצוב מתקדמים<br>
                            ✅ Undo/Redo מלא<br>
                            ✅ לוח צבעים מקצועי
                        </div>
                    </div>
                    <iframe class="website-iframe" id="websiteIframe" style="display: none;"></iframe>
                    <div class="frame-overlay" id="frameOverlay"></div>
                </div>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel">
            <div class="panel-tabs">
                <button class="panel-tab active" onclick="switchPropertiesTab('element', this)">
                    <i class="fas fa-mouse-pointer"></i>
                    אלמנט
                </button>
                <button class="panel-tab" onclick="switchPropertiesTab('layout', this)">
                    <i class="fas fa-th-large"></i>
                    פריסה
                </button>
                <button class="panel-tab" onclick="switchPropertiesTab('effects', this)">
                    <i class="fas fa-magic"></i>
                    אפקטים
                </button>
            </div>

            <div class="properties-content" id="propertiesContent">
                <!-- Element Properties -->
                <div id="elementProperties">
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-mouse-pointer"></i>
                            מאפייני אלמנט נבחר
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">טקסט:</label>
                            <input type="text" class="form-control" id="elementText" placeholder="בחר אלמנט לעריכה" onchange="updateElementText(this.value)">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">צבע טקסט:</label>
                            <input type="color" class="color-input" id="textColor" value="#333333" onchange="applyTextColor(this.value)">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">צבע רקע:</label>
                            <input type="color" class="color-input" id="bgColor" value="#ffffff" onchange="applyBackgroundColor(this.value)">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">גודל פונט: <span id="fontSizeValue" class="range-value">16px</span></label>
                            <input type="range" class="range-input" min="8" max="72" value="16" id="fontSize" onchange="applyFontSize(this.value)">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">רווח שורה: <span id="lineHeightValue" class="range-value">1.5</span></label>
                            <input type="range" class="range-input" min="1" max="3" step="0.1" value="1.5" id="lineHeight" onchange="applyLineHeight(this.value)">
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-expand-arrows-alt"></i>
                            מרווחים ומיקום
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">רווח פנימי: <span id="paddingValue" class="range-value">20px</span></label>
                            <input type="range" class="range-input" min="0" max="100" value="20" id="padding" onchange="applyPadding(this.value)">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">רווח חיצוני: <span id="marginValue" class="range-value">10px</span></label>
                            <input type="range" class="range-input" min="0" max="100" value="10" id="margin" onchange="applyMargin(this.value)">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">יישור טקסט:</label>
                            <select class="form-control" id="textAlign" onchange="applyTextAlign(this.value)">
                                <option value="right">ימין</option>
                                <option value="center">מרכז</option>
                                <option value="left">שמאל</option>
                                <option value="justify">מוצדק</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Layout Properties (hidden by default) -->
                <div id="layoutProperties" style="display: none;">
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-th-large"></i>
                            פריסה ותצוגה
                        </div>
                        <p>כלי פריסה מתקדמים יתווספו כאן...</p>
                    </div>
                </div>

                <!-- Effects Properties (hidden by default) -->
                <div id="effectsProperties" style="display: none;">
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-magic"></i>
                            אפקטים וצללים
                        </div>
                        <p>אפקטים מתקדמים יתווספו כאן...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-info">
            <div class="status-item">
                <div class="status-indicator" id="statusIndicator"></div>
                <span id="statusText">מוכן לעבודה</span>
            </div>
            <div class="status-item">
                <i class="fas fa-mouse-pointer"></i>
                <span id="selectedElement">אין אלמנט נבחר</span>
            </div>
            <div class="status-item">
                <i class="fas fa-eye"></i>
                <span id="currentDevice">מחשב</span>
            </div>
        </div>
        <div class="status-info">
            <div class="status-item">
                <i class="fas fa-save"></i>
                <span id="autoSaveStatus">שמירה אוטומטית: פעילה</span>
            </div>
            <div class="status-item">
                <i class="fas fa-history"></i>
                <span id="historyStatus">שינויים: 0</span>
            </div>
            <div class="status-item">
                <i class="fas fa-wifi"></i>
                <span>מחובר</span>
            </div>
        </div>
    </div>

    <!-- AI Assistant Toggle -->
    <button class="ai-toggle" id="aiToggle" onclick="toggleAI()">
        <i class="fas fa-robot"></i>
    </button>

    <!-- AI Assistant Panel -->
    <div class="ai-assistant" id="aiAssistant">
        <div class="ai-header">
            <div style="display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-robot"></i>
                <span>AI Assistant</span>
            </div>
            <button onclick="toggleAI()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="ai-content">
            <input type="text" class="ai-input" id="aiInput" placeholder="שאל אותי משהו על העיצוב..." onkeypress="handleAIInput(event)">
            <div class="ai-suggestions">
                <div class="suggestion-chip" onclick="askAI('שנה צבעים')">שנה צבעים</div>
                <div class="suggestion-chip" onclick="askAI('שפר עיצוב')">שפר עיצוב</div>
                <div class="suggestion-chip" onclick="askAI('הוסף אנימציה')">הוסף אנימציה</div>
                <div class="suggestion-chip" onclick="askAI('אופטימיזציה')">אופטימיזציה</div>
            </div>
            <div id="aiResponse" style="font-size: 14px; line-height: 1.6; color: var(--text-secondary);">
                שלום! אני כאן לעזור לך לשפר את העיצוב. תוכל לשאול אותי שאלות על צבעים, פונטים, פריסה ועוד.
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div class="notification" id="notification" style="display: none;">
        <div class="notification-content">
            <i class="notification-icon" id="notificationIcon"></i>
            <span class="notification-text" id="notificationText"></span>
        </div>
    </div>

    <script>
        console.log('🚀 WebMaster Pro אדיטור מתקדם מתחיל...');

        // Global Variables
        let currentWebsite = null;
        let currentDevice = 'desktop';
        let selectedElement = null;
        let editMode = false;
        let inspectorMode = false;
        let currentColor = '#667eea';
        let changeHistory = [];
        let historyIndex = -1;
        let autoSaveInterval = null;
        let isAIOpen = false;

        // Website Database
        const websites = {
            'dr-michal-rosen': {
                name: 'ד"ר מיכל רוזן',
                category: 'רפואה אסתטית',
                price: 2800,
                description: 'מרפאת אסתטיקה רפואית מתקדמת עם טיפולי יופי חדשניים',
                file: 'websites/dr-michal-rosen.html',
                status: 'מוכן',
                lastModified: '2025-01-15'
            },
            'fitness-coach': {
                name: 'דני פיט',
                category: 'מאמן כושר',
                price: 2200,
                description: 'מאמן כושר אישי מוסמך עם ניסיון רב שנים בפיתוח גוף',
                file: 'websites/fitness-co.html',
                status: 'מוכן',
                lastModified: '2025-01-10'
            },
            'yoga-studio': {
                name: 'סטודיו אוהם',
                category: 'יוגה ומדיטציה',
                price: 1900,
                description: 'מרחב של שלווה, איזון ותנועה מודעת לגוף ולנפש',
                file: 'websites/yoga-studio.html',
                status: 'מוכן',
                lastModified: '2025-01-08'
            },
            'nutritionist': {
                name: 'ד"ר שרה כהן',
                category: 'תזונאית קלינית',
                price: 2400,
                description: 'תזונאית קלינית מוסמכת עם התמחות בהרזיה בריאה',
                file: 'websites/nutritionist.html',
                status: 'מוכן',
                lastModified: '2025-01-12'
            },
            'law-firm': {
                name: 'משרד ברקוביץ',
                category: 'עורכי דין',
                price: 2500,
                description: 'משרד עורכי דין מוביל עם ניסיון רב שנים בדיני מסחר',
                file: 'websites/law-firm.html',
                status: 'מוכן',
                lastModified: '2025-01-05'
            },
            'accountant': {
                name: 'רינה לוי',
                category: 'חשבת שכר',
                price: 2000,
                description: 'שירותי שכר וחשבונאות מקצועיים לעסקים קטנים ובינוניים',
                file: 'websites/accountant.html',
                status: 'מוכן',
                lastModified: '2025-01-07'
            },
            'beauty-salon': {
                name: 'מספרה BELLA',
                category: 'יופי ועיצוב שיער',
                price: 1700,
                description: 'סלון יופי מוביל עם הטכנולוגיות העדכניות בעיצוב שיער',
                file: 'websites/beauty-salon.html',
                status: 'מוכן',
                lastModified: '2025-01-03'
            },
            'tutor': {
                name: 'ד"ר רונית לוי',
                category: 'מורה פרטית',
                price: 2100,
                description: 'מורה פרטית מנוסה עם דוקטורט בחינוך ופסיכולוגיה',
                file: 'websites/tutor.html',
                status: 'מוכן',
                lastModified: '2025-01-09'
            },
            'aesthetic-clinic': {
                name: 'קליניקת יופי פרמיום',
                category: 'אסתטיקה רפואית',
                price: 3200,
                description: 'מרכז רפואה אסתטית מתקדמת לחידוש העור וטיפולי יופי',
                file: 'websites/aesthetic-clinic.html',
                status: 'מוכן - פרמיום',
                lastModified: '2025-01-15'
            },
            'multibrawn': {
                name: 'מולטיבראון',
                category: 'נופש ואירועים',
                price: 2300,
                description: 'חברה מובילה בתחום הנופש והאירועים הקורפורטיביים',
                file: 'websites/multibrawn.html',
                status: 'מוכן',
                lastModified: '2025-01-11'
            },
            'real-estate': {
                name: 'נדל"ן פרמיום',
                category: 'נדל"ן יוקרה',
                price: 2700,
                description: 'חברת נדל"ן מתמחה בנכסי פרמיום ויוקרה בישראל',
                file: 'websites/real-estate.html',
                status: 'מוכן',
                lastModified: '2025-01-13'
            }
        };

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('✅ DOM נטען, מתחיל אתחול מערכת מתקדמת...');
            try {
                initializeAdvancedEditor();
                setupEventListeners();
                startAutoSave();
                showNotification('success', '🚀 WebMaster Pro מתקדם מוכן לעבודה! פיצ'רים חדשים זמינים.');
            } catch (error) {
                console.error('❌ שגיאה באתחול:', error);
                showNotification('error', 'שגיאה באתחול המערכת המתקדמת');
            }
        });

        function initializeAdvancedEditor() {
            console.log('🔧 מאתחל אדיטור מתקדם...');
            updateStatus('מוכן לעבודה מתקדמת', false);
            
            // Initialize advanced editor state
            currentDevice = 'desktop';
            editMode = false;
            selectedElement = null;
            inspectorMode = false;
            currentColor = '#667eea';
            changeHistory = [];
            historyIndex = -1;
            
            // Initialize color palette
            initializeColorPalette();
            
            console.log('📊 זמין: ' + Object.keys(websites).length + ' אתרים בשווי ₪' + 
                       Object.values(websites).reduce((sum, site) => sum + site.price, 0).toLocaleString());
            console.log('🚀 פיצ'רים מתקדמים: עריכה בזמן אמת, AI Assistant, Undo/Redo');
        }

        function setupEventListeners() {
            // Website selector
            const selector = document.getElementById('websiteSelector');
            if (selector) {
                selector.addEventListener('change', function() {
                    const websiteId = this.value;
                    if (websiteId && websites[websiteId]) {
                        loadWebsiteAdvanced(websiteId);
                    }
                });
            }

            // Listen for messages from iframe for advanced editing
            window.addEventListener('message', function(event) {
                handleIframeMessage(event);
            });

            // Advanced form controls
            setupAdvancedFormControls();
        }

        function setupAdvancedFormControls() {
            // Real-time text editing
            const elementText = document.getElementById('elementText');
            if (elementText) {
                elementText.addEventListener('input', function() {
                    updateElementText(this.value);
                });
            }

            // Color controls with live preview
            setupColorControls();
        }

        function setupColorControls() {
            const textColor = document.getElementById('textColor');
            const bgColor = document.getElementById('bgColor');
            const customColor = document.getElementById('customColor');

            if (textColor) {
                textColor.addEventListener('input', function() {
                    applyTextColor(this.value);
                });
            }

            if (bgColor) {
                bgColor.addEventListener('input', function() {
                    applyBackgroundColor(this.value);
                });
            }

            if (customColor) {
                customColor.addEventListener('input', function() {
                    selectColor(this.value);
                });
            }
        }

        function loadWebsiteAdvanced(websiteId) {
            console.log('📂 טוען אתר מתקדם:', websiteId);
            updateStatus('טוען אתר עם תכונות מתקדמות...', true);

            const website = websites[websiteId];
            currentWebsite = websiteId;

            // Update website info display
            updateWebsiteInfo(website);

            const iframe = document.getElementById('websiteIframe');
            const placeholder = document.getElementById('placeholder');

            console.log('🔍 מחפש קובץ באתיב:', website.file);
            
            // Add loading overlay
            showLoadingOverlay();
            
            // First, try to load the actual file
            iframe.src = website.file;
            
            iframe.onload = function() {
                setTimeout(function() {
                    try {
                        const iframeWindow = iframe.contentWindow;
                        const iframeDoc = iframe.contentDocument || iframeWindow.document;
                        
                        if (iframeDoc && iframeDoc.documentElement && 
                            iframeDoc.documentElement.innerHTML.length > 100) {
                            
                            // File loaded successfully - inject editing capabilities
                            injectEditingCapabilities(iframeDoc);
                            
                            iframe.style.display = 'block';
                            placeholder.style.display = 'none';
                            hideLoadingOverlay();
                            updateStatus('אתר נטען עם יכולות עריכה מתקדמות', false);
                            showNotification('success', '✅ אתר "' + website.name + '" נטען עם תכונות עריכה מתקדמות!');
                            console.log('✅ נטען בהצלחה עם עריכה מתקדמת:', website.file);
                        } else {
                            throw new Error('File not found or empty');
                        }
                    } catch (error) {
                        console.log('📝 קובץ לא נמצא, יוצר תוכן זמני מתקדם עבור:', website.name);
                        loadAdvancedFallbackContent(website, iframe, placeholder);
                    }
                }, 500);
            };

            iframe.onerror = function() {
                console.log('❌ שגיאה בטעינה, יוצר תוכן זמני מתקדם עבור:', website.name);
                loadAdvancedFallbackContent(website, iframe, placeholder);
            };
            
            setTimeout(function() {
                if (iframe.style.display === 'none') {
                    console.log('⏰ זמן קצוב חלף, יוצר תוכן זמני מתקדם עבור:', website.name);
                    loadAdvancedFallbackContent(website, iframe, placeholder);
                }
            }, 3000);
        }

        function injectEditingCapabilities(iframeDoc) {
            // Inject CSS for editing highlights and interactions
            const editingCSS = `
                <style>
                    .webmaster-editable {
                        transition: all 0.3s ease !important;
                        border-radius: 4px !important;
                        min-height: 20px !important;
                        position: relative !important;
                    }
                    .webmaster-editable:hover {
                        outline: 2px dashed rgba(102, 126, 234, 0.7) !important;
                        background: rgba(102, 126, 234, 0.05) !important;
                        cursor: pointer !important;
                    }
                    .webmaster-selected {
                        outline: 3px solid #667eea !important;
                        background: rgba(102, 126, 234, 0.1) !important;
                    }
                    .webmaster-editing {
                        outline: 3px solid #26de81 !important;
                        background: rgba(38, 222, 129, 0.1) !important;
                    }
                </style>
            `;
            
            iframeDoc.head.insertAdjacentHTML('beforeend', editingCSS);

            // Make elements editable
            const editableElements = iframeDoc.querySelectorAll('h1, h2, h3, h4, h5, h6, p, span, a, button, div');
            editableElements.forEach(element => {
                if (element.textContent.trim() && !element.querySelector('img')) {
                    element.classList.add('webmaster-editable');
                    element.addEventListener('click', function(e) {
                        e.preventDefault();
                        selectElementForEditing(element);
                    });
                    element.addEventListener('dblclick', function(e) {
                        e.preventDefault();
                        enableInlineEditing(element);
                    });
                }
            });

            console.log('🎨 הוזרקו יכולות עריכה למסמך:', editableElements.length, 'אלמנטים');
        }

        function selectElementForEditing(element) {
            // Remove previous selection
            const iframe = document.getElementById('websiteIframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            const previousSelected = iframeDoc.querySelector('.webmaster-selected');
            if (previousSelected) {
                previousSelected.classList.remove('webmaster-selected');
            }

            // Add selection to current element
            element.classList.add('webmaster-selected');
            selectedElement = element;

            // Update properties panel
            updatePropertiesPanel(element);
            updateStatus('אלמנט נבחר: ' + (element.tagName.toLowerCase()), false);
            document.getElementById('selectedElement').textContent = 'נבחר: ' + element.tagName;

            // Send message to parent
            window.parent.postMessage({
                type: 'elementSelected',
                tagName: element.tagName,
                text: element.textContent.trim(),
                styles: getComputedStyle(element)
            }, '*');

            showNotification('info', 'אלמנט נבחר - ניתן לערוך בפאנל הימני');
        }

        function enableInlineEditing(element) {
            if (element.contentEditable === 'true') return;

            element.classList.add('webmaster-editing');
            element.contentEditable = true;
            element.focus();

            // Select all text
            const range = document.createRange();
            range.selectNodeContents(element);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);

            const originalText = element.textContent;

            element.addEventListener('blur', function() {
                finishInlineEditing(element, originalText);
            });

            element.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    element.blur();
                } else if (e.key === 'Escape') {
                    element.textContent = originalText;
                    element.blur();
                }
            });

            showNotification('success', 'עריכה פעילה - Enter לשמירה, Escape לביטול');
        }

        function finishInlineEditing(element, originalText) {
            element.contentEditable = false;
            element.classList.remove('webmaster-editing');
            
            const newText = element.textContent.trim();
            if (newText !== originalText) {
                // Add to history
                addToHistory({
                    type: 'textChange',
                    element: element,
                    oldValue: originalText,
                    newValue: newText
                });
                
                updateHistoryStatus();
                showNotification('success', 'טקסט עודכן בהצלחה');
            }
        }

        function updatePropertiesPanel(element) {
            const styles = getComputedStyle(element);
            
            // Update text input
            document.getElementById('elementText').value = element.textContent.trim();
            
            // Update color inputs
            document.getElementById('textColor').value = rgbToHex(styles.color);
            document.getElementById('bgColor').value = rgbToHex(styles.backgroundColor);
            
            // Update font size
            const fontSize = parseInt(styles.fontSize);
            document.getElementById('fontSize').value = fontSize;
            document.getElementById('fontSizeValue').textContent = fontSize + 'px';
            
            // Update line height
            const lineHeight = parseFloat(styles.lineHeight) / fontSize || 1.5;
            document.getElementById('lineHeight').value = lineHeight;
            document.getElementById('lineHeightValue').textContent = lineHeight;
            
            // Update text align
            document.getElementById('textAlign').value = styles.textAlign;
        }

        function rgbToHex(rgb) {
            if (rgb.startsWith('#')) return rgb;
            if (rgb === 'transparent' || rgb === 'rgba(0, 0, 0, 0)') return '#ffffff';
            
            const result = rgb.match(/\d+/g);
            if (!result) return '#000000';
            
            return '#' + result.slice(0, 3).map(x => {
                const hex = parseInt(x).toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            }).join('');
        }

        // Advanced editing functions
        function updateElementText(text) {
            if (selectedElement) {
                const oldText = selectedElement.textContent;
                selectedElement.textContent = text;
                
                addToHistory({
                    type: 'textChange',
                    element: selectedElement,
                    oldValue: oldText,
                    newValue: text
                });
                
                updateHistoryStatus();
            }
        }

        function applyTextColor(color) {
            if (selectedElement) {
                const oldColor = selectedElement.style.color;
                selectedElement.style.color = color;
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'color',
                    oldValue: oldColor,
                    newValue: color
                });
                
                updateHistoryStatus();
                showNotification('success', 'צבע טקסט עודכן ל-' + color);
            }
        }

        function applyBackgroundColor(color) {
            if (selectedElement) {
                const oldColor = selectedElement.style.backgroundColor;
                selectedElement.style.backgroundColor = color;
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'backgroundColor',
                    oldValue: oldColor,
                    newValue: color
                });
                
                updateHistoryStatus();
                showNotification('success', 'צבע רקע עודכן ל-' + color);
            }
        }

        function applyFontSize(size) {
            if (selectedElement) {
                const oldSize = selectedElement.style.fontSize;
                selectedElement.style.fontSize = size + 'px';
                document.getElementById('fontSizeValue').textContent = size + 'px';
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'fontSize',
                    oldValue: oldSize,
                    newValue: size + 'px'
                });
                
                updateHistoryStatus();
            }
        }

        function applyLineHeight(height) {
            if (selectedElement) {
                const oldHeight = selectedElement.style.lineHeight;
                selectedElement.style.lineHeight = height;
                document.getElementById('lineHeightValue').textContent = height;
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'lineHeight',
                    oldValue: oldHeight,
                    newValue: height
                });
                
                updateHistoryStatus();
            }
        }

        function applyPadding(padding) {
            if (selectedElement) {
                const oldPadding = selectedElement.style.padding;
                selectedElement.style.padding = padding + 'px';
                document.getElementById('paddingValue').textContent = padding + 'px';
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'padding',
                    oldValue: oldPadding,
                    newValue: padding + 'px'
                });
                
                updateHistoryStatus();
            }
        }

        function applyMargin(margin) {
            if (selectedElement) {
                const oldMargin = selectedElement.style.margin;
                selectedElement.style.margin = margin + 'px';
                document.getElementById('marginValue').textContent = margin + 'px';
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'margin',
                    oldValue: oldMargin,
                    newValue: margin + 'px'
                });
                
                updateHistoryStatus();
            }
        }

        function applyTextAlign(align) {
            if (selectedElement) {
                const oldAlign = selectedElement.style.textAlign;
                selectedElement.style.textAlign = align;
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'textAlign',
                    oldValue: oldAlign,
                    newValue: align
                });
                
                updateHistoryStatus();
            }
        }

        function applyFontFamily(family) {
            if (selectedElement) {
                const oldFamily = selectedElement.style.fontFamily;
                selectedElement.style.fontFamily = family;
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'fontFamily',
                    oldValue: oldFamily,
                    newValue: family
                });
                
                updateHistoryStatus();
                showNotification('success', 'פונט עודכן');
            }
        }

        function applyFontWeight(weight) {
            if (selectedElement) {
                const oldWeight = selectedElement.style.fontWeight;
                const newWeight = selectedElement.style.fontWeight === 'bold' ? 'normal' : 'bold';
                selectedElement.style.fontWeight = newWeight;
                
                const btn = document.getElementById('boldBtn');
                btn.classList.toggle('active');
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'fontWeight',
                    oldValue: oldWeight,
                    newValue: newWeight
                });
                
                updateHistoryStatus();
            }
        }

        function applyFontStyle(style) {
            if (selectedElement) {
                const oldStyle = selectedElement.style.fontStyle;
                const newStyle = selectedElement.style.fontStyle === 'italic' ? 'normal' : 'italic';
                selectedElement.style.fontStyle = newStyle;
                
                const btn = document.getElementById('italicBtn');
                btn.classList.toggle('active');
                
                addToHistory({
                    type: 'styleChange',
                    element: selectedElement,
                    property: 'fontStyle',
                    oldValue: oldStyle,
                    newValue: newStyle
                });
                
                updateHistoryStatus();
            }
        }

        // History management
        function addToHistory(change) {
            // Remove any history after current index
            changeHistory = changeHistory.slice(0, historyIndex + 1);
            
            // Add new change
            changeHistory.push(change);
            historyIndex++;
            
            // Limit history size
            if (changeHistory.length > 50) {
                changeHistory.shift();
                historyIndex--;
            }
        }

        function undoChange() {
            if (historyIndex >= 0) {
                const change = changeHistory[historyIndex];
                applyReverseChange(change);
                historyIndex--;
                updateHistoryStatus();
                showNotification('info', 'שינוי בוטל');
            } else {
                showNotification('warning', 'אין שינויים לביטול');
            }
        }

        function redoChange() {
            if (historyIndex < changeHistory.length - 1) {
                historyIndex++;
                const change = changeHistory[historyIndex];
                applyChange(change);
                updateHistoryStatus();
                showNotification('info', 'שינוי הוחזר');
            } else {
                showNotification('warning', 'אין שינויים להחזרה');
            }
        }

        function applyReverseChange(change) {
            if (change.type === 'textChange') {
                change.element.textContent = change.oldValue;
            } else if (change.type === 'styleChange') {
                change.element.style[change.property] = change.oldValue;
            }
        }

        function applyChange(change) {
            if (change.type === 'textChange') {
                change.element.textContent = change.newValue;
            } else if (change.type === 'styleChange') {
                change.element.style[change.property] = change.newValue;
            }
        }

        function updateHistoryStatus() {
            document.getElementById('historyStatus').textContent = 'שינויים: ' + changeHistory.length;
        }

        // Color palette functions
        function initializeColorPalette() {
            const swatches = document.querySelectorAll('.color-swatch');
            swatches.forEach(swatch => {
                swatch.addEventListener('click', function() {
                    const color = this.style.backgroundColor;
                    selectColor(rgbToHex(color));
                });
            });
        }

        function selectColor(color) {
            currentColor = color;
            
            // Update active swatch
            document.querySelectorAll('.color-swatch').forEach(swatch => {
                swatch.classList.remove('active');
                if (rgbToHex(swatch.style.backgroundColor) === color) {
                    swatch.classList.add('active');
                }
            });
            
            // Update color inputs
            document.getElementById('customColor').value = color;
            
            showNotification('info', 'צבע נבחר: ' + color);
        }

        // Advanced tools
        function enableAdvancedEdit() {
            editMode = !editMode;
            const btn = document.getElementById('editModeBtn');
            const overlay = document.getElementById('frameOverlay');
            
            if (editMode) {
                btn.classList.add('active');
                overlay.classList.add('edit-mode');
                showNotification('success', '🖊️ מצב עריכה מתקדם פעיל - לחץ על אלמנטים לעריכה');
            } else {
                btn.classList.remove('active');
                overlay.classList.remove('edit-mode');
                showNotification('info', 'מצב עריכה מתקדם כבוי');
            }
        }

        function toggleInspector() {
            inspectorMode = !inspectorMode;
            const btn = document.getElementById('inspectorBtn');
            
            if (inspectorMode) {
                btn.classList.add('active');
                showNotification('success', '🔍 בוחן אלמנטים פעיל - הצבע על אלמנטים לבדיקה');
            } else {
                btn.classList.remove('active');
                showNotification('info', 'בוחן אלמנטים כבוי');
            }
        }

        // Device controls
        function setDevice(device) {
            currentDevice = device;
            
            // Update button states
            document.querySelectorAll('.device-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(device + 'Btn').classList.add('active');
            
            // Update frame size
            const frame = document.getElementById('websiteFrame');
            frame.className = `website-frame ${device}`;
            
            const deviceNames = {
                desktop: 'מחשב',
                tablet: 'טאבלט', 
                mobile: 'מובייל'
            };
            
            document.getElementById('currentDevice').textContent = deviceNames[device];
            showNotification('info', `עבר למצב ${deviceNames[device]}`);
        }

        function updateZoom(value) {
            const frame = document.getElementById('websiteFrame');
            frame.style.transform = `scale(${value / 100})`;
            document.getElementById('zoomValue').textContent = `${value}%`;
        }

        function resetZoom() {
            document.getElementById('zoomSlider').value = 100;
            updateZoom(100);
            showNotification('info', 'זום אופס ל-100%');
        }

        // Tab switching
        function switchTab(tabName, button) {
            // Update button states
            document.querySelectorAll('.panel-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            button.classList.add('active');
            
            // Hide all tabs
            document.getElementById('designTab').style.display = 'none';
            document.getElementById('contentTab').style.display = 'none';
            document.getElementById('mediaTab').style.display = 'none';
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').style.display = 'block';
            
            showNotification('info', `עבר לטאב ${tabName}`);
        }

        function switchPropertiesTab(tabName, button) {
            // Update button states
            button.parentElement.querySelectorAll('.panel-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            button.classList.add('active');
            
            // Hide all properties
            document.getElementById('elementProperties').style.display = 'none';
            document.getElementById('layoutProperties').style.display = 'none';
            document.getElementById('effectsProperties').style.display = 'none';
            
            // Show selected properties
            document.getElementById(tabName + 'Properties').style.display = 'block';
            
            showNotification('info', `עבר למאפייני ${tabName}`);
        }

        // AI Assistant
        function toggleAI() {
            isAIOpen = !isAIOpen;
            const assistant = document.getElementById('aiAssistant');
            const toggle = document.getElementById('aiToggle');
            
            if (isAIOpen) {
                assistant.classList.add('open');
                toggle.style.display = 'none';
            } else {
                assistant.classList.remove('open');
                toggle.style.display = 'flex';
            }
        }

        function handleAIInput(event) {
            if (event.key === 'Enter') {
                const input = document.getElementById('aiInput');
                askAI(input.value);
                input.value = '';
            }
        }

        function askAI(question) {
            const response = document.getElementById('aiResponse');
            response.innerHTML = '<i class="fas fa-spinner fa-spin"></i> AI חושב...';
            
            // Simulate AI response
            setTimeout(() => {
                const responses = {
                    'שנה צבעים': 'מציע לשנות לצבעים כחול-סגול (#667eea) עם ירוק מנטה (#26de81) כצבע משני. זה יעניק מראה מקצועי ונעים לעין.',
                    'שפר עיצוב': 'מציע להוסיף צללים עדינים, להגדיל מרווחים בין אלמנטים ולהשתמש בפונט Heebo לטקסט עברי.',
                    'הוסף אנימציה': 'מציע להוסיף אנימציות hover עדינות לכפתורים ומעברים חלקים בין דפים.',
                    'אופטימיזציה': 'מציע לדחוס תמונות, לשפר SEO עם meta tags ולהוסיף lazy loading לתמונות.'
                };
                
                response.innerHTML = responses[question] || 'מצטער, לא הבנתי את השאלה. תוכל לנסח אותה אחרת?';
            }, 1500);
        }

        // Advanced website loading
        function loadAdvancedFallbackContent(website, iframe, placeholder) {
            const generatedHTML = generateAdvancedProfessionalWebsite(website);
            iframe.src = '';
            iframe.srcdoc = generatedHTML;
            
            iframe.onload = function() {
                // Inject editing capabilities to generated content
                setTimeout(() => {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    injectEditingCapabilities(iframeDoc);
                }, 500);
                
                iframe.style.display = 'block';
                placeholder.style.display = 'none';
                hideLoadingOverlay();
                updateStatus('אתר זמני נטען עם תכונות מתקדמות', false);
                showNotification('warning', '⚠️ קובץ ' + website.file + ' לא נמצא, נטען תוכן זמני מתקדם');
            };
        }

        function generateAdvancedProfessionalWebsite(website) {
            return `<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${website.name} - ${website.category}</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Heebo', 'Segoe UI', Arial, sans-serif; 
            line-height: 1.6; 
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 2rem; 
            text-align: center;
            color: white;
        }
        .hero {
            padding: 4rem 0;
        }
        h1 { 
            font-size: 3.5rem; 
            margin-bottom: 1rem; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: 700;
        }
        .subtitle { 
            font-size: 1.5rem; 
            margin-bottom: 2rem; 
            opacity: 0.9;
            font-weight: 300;
        }
        .services {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 25px;
            padding: 3rem;
            margin: 2rem 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        .services h2 {
            margin-bottom: 2rem;
            font-size: 2.5rem;
            font-weight: 600;
        }
        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        .service-card {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            padding: 2.5rem;
            transition: all 0.4s ease;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            background: rgba(255,255,255,0.25);
        }
        .service-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #26de81, #20bf6b);
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 10px 25px rgba(38, 222, 129, 0.3);
        }
        .service-card h3 {
            margin-bottom: 1rem;
            font-size: 1.4rem;
            font-weight: 600;
        }
        .service-card p {
            margin-bottom: 1.5rem;
            line-height: 1.7;
            opacity: 0.9;
        }
        .price {
            color: #26de81;
            font-weight: 700;
            font-size: 1.3rem;
            background: rgba(38, 222, 129, 0.2);
            padding: 8px 16px;
            border-radius: 25px;
            display: inline-block;
        }
        .contact {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 25px;
            padding: 2.5rem;
            margin-top: 2rem;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        .contact h2 {
            margin-bottom: 1rem;
            font-size: 2rem;
        }
        .contact-info {
            margin: 1.5rem 0;
            font-size: 1.1rem;
        }
        .cta-button {
            background: linear-gradient(45deg, #26de81, #20bf6b);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            margin: 1rem;
            transition: all 0.4s ease;
            box-shadow: 0 8px 20px rgba(38, 222, 129, 0.3);
            text-decoration: none;
            display: inline-block;
        }
        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(38, 222, 129, 0.4);
            background: linear-gradient(45deg, #20bf6b, #26de81);
        }
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            .subtitle { font-size: 1.2rem; }
            .service-grid { grid-template-columns: 1fr; }
            .container { padding: 1rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>${website.name}</h1>
            <p class="subtitle">${website.description} - חדשנות ומקצועיות ברמה הגבוהה ביותר</p>
            <a href="#contact" class="cta-button">צור קשר עכשיו</a>
        </div>
        
        <div class="services">
            <h2>השירותים המקצועיים שלנו</h2>
            <div class="service-grid">
                <div class="service-card">
                    <div class="service-icon">⭐</div>
                    <h3>שירות מקצועי מותאם</h3>
                    <p>פתרונות מותאמים אישית עם דגש על איכות מעולה ותוצאות מוכחות. אנו מספקים שירות ברמה הגבוהה ביותר.</p>
                    <div class="price">החל מ-₪399</div>
                </div>
                <div class="service-card">
                    <div class="service-icon">🚀</div>
                    <h3>פתרונות חדשניים</h3>
                    <p>שימוש בטכנולוגיות המתקדמות ביותר ובשיטות עבודה חדשניות לקבלת התוצאות הטובות ביותר.</p>
                    <div class="price">החל מ-₪599</div>
                </div>
                <div class="service-card">
                    <div class="service-icon">💎</div>
                    <h3>שירות פרמיום</h3>
                    <p>חבילה מקיפה הכוללת כל מה שנדרש עם תמיכה מלאה ומעקב אישי לקבלת תוצאות מושלמות.</p>
                    <div class="price">החל מ-₪899</div>
                </div>
            </div>
        </div>
        
        <div class="contact" id="contact">
            <h2>צור קשר</h2>
            <p>נשמח לענות על כל שאלה ולתת ייעוץ מקצ
